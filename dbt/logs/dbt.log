[0m17:51:09.612259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa847681d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa847852310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa847852f10>]}


============================== 17:51:09.627333 | 80eb8c37-bd4a-48a8-9629-e1e235f2d713 ==============================
[0m17:51:09.627333 [info ] [MainThread]: Running with dbt=1.7.16
[0m17:51:09.629483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:09.632261 [info ] [MainThread]: dbt version: 1.7.16
[0m17:51:09.634001 [info ] [MainThread]: python version: 3.11.2
[0m17:51:09.635522 [info ] [MainThread]: python path: /usr/local/bin/python
[0m17:51:09.636820 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m17:51:09.820026 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m17:51:09.821992 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m17:51:09.823536 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m17:51:09.825305 [info ] [MainThread]: adapter type: postgres
[0m17:51:09.826811 [info ] [MainThread]: adapter version: 1.7.16
[0m17:51:09.980758 [info ] [MainThread]: Configuration:
[0m17:51:09.982817 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:51:09.984655 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:51:09.986318 [info ] [MainThread]: Required dependencies:
[0m17:51:09.988026 [debug] [MainThread]: Executing "git --help"
[0m17:51:10.003935 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:51:10.005658 [debug] [MainThread]: STDERR: "b''"
[0m17:51:10.007139 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:51:10.008856 [info ] [MainThread]: Connection:
[0m17:51:10.010189 [info ] [MainThread]:   host: postgres
[0m17:51:10.011900 [info ] [MainThread]:   port: 5432
[0m17:51:10.013272 [info ] [MainThread]:   user: demo
[0m17:51:10.014525 [info ] [MainThread]:   database: demo
[0m17:51:10.015706 [info ] [MainThread]:   schema: analytics
[0m17:51:10.016862 [info ] [MainThread]:   connect_timeout: 10
[0m17:51:10.018024 [info ] [MainThread]:   role: None
[0m17:51:10.019229 [info ] [MainThread]:   search_path: None
[0m17:51:10.020385 [info ] [MainThread]:   keepalives_idle: 0
[0m17:51:10.021621 [info ] [MainThread]:   sslmode: None
[0m17:51:10.022794 [info ] [MainThread]:   sslcert: None
[0m17:51:10.024089 [info ] [MainThread]:   sslkey: None
[0m17:51:10.025549 [info ] [MainThread]:   sslrootcert: None
[0m17:51:10.026769 [info ] [MainThread]:   application_name: dbt
[0m17:51:10.028024 [info ] [MainThread]:   retries: 1
[0m17:51:10.029330 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m17:51:10.030953 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:51:10.032162 [debug] [MainThread]: Using postgres connection "debug"
[0m17:51:10.033237 [debug] [MainThread]: On debug: select 1 as id
[0m17:51:10.034286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:10.072543 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:51:10.075492 [debug] [MainThread]: On debug: Close
[0m17:51:10.077491 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:51:10.079114 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:51:10.082176 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.578182, "process_user_time": 4.276369, "process_kernel_time": 0.263472, "process_mem_max_rss": "102700", "process_out_blocks": "1216", "process_in_blocks": "0"}
[0m17:51:10.083748 [debug] [MainThread]: Command `dbt debug` succeeded at 17:51:10.083503 after 0.58 seconds
[0m17:51:10.084849 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:51:10.086070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa847681790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa845f6dcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa845f87cd0>]}
[0m17:51:10.087573 [debug] [MainThread]: Flushing usage events
[0m17:51:17.231401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf61bba990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6221a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf61b8b350>]}


============================== 17:51:17.237016 | 0b298c65-722c-4dd6-afc3-0deecebdb2da ==============================
[0m17:51:17.237016 [info ] [MainThread]: Running with dbt=1.7.16
[0m17:51:17.239598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:17.782746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b298c65-722c-4dd6-afc3-0deecebdb2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf61d5ef50>]}
[0m17:51:18.035871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b298c65-722c-4dd6-afc3-0deecebdb2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf61d661d0>]}
[0m17:51:18.042621 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m17:51:18.102038 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m17:51:18.393666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:51:18.396532 [debug] [MainThread]: Partial parsing: updated file: retail_poc://models/marts/fact_orders.sql
[0m17:51:18.399897 [debug] [MainThread]: Partial parsing: updated file: retail_poc://models/staging/stg_transactions.sql
[0m17:51:18.735368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b298c65-722c-4dd6-afc3-0deecebdb2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf60522490>]}
[0m17:51:18.780388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b298c65-722c-4dd6-afc3-0deecebdb2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6023c1d0>]}
[0m17:51:18.782755 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:51:18.785301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b298c65-722c-4dd6-afc3-0deecebdb2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf64b39850>]}
[0m17:51:18.790190 [info ] [MainThread]: 
[0m17:51:18.794993 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:51:18.800249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m17:51:18.827176 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m17:51:18.830660 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m17:51:18.834360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:18.857267 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:51:18.862068 [debug] [ThreadPool]: On list_demo: Close
[0m17:51:18.871484 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m17:51:18.873634 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m17:51:18.876132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:18.892533 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:51:18.897488 [debug] [ThreadPool]: On list_demo: Close
[0m17:51:18.901512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_analytics_analytics_staging)
[0m17:51:18.905323 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_analytics_staging"
"
[0m17:51:18.923788 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m17:51:18.928529 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: BEGIN
[0m17:51:18.931146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:18.949409 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:51:18.951537 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m17:51:18.953260 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_analytics_staging"} */
create schema if not exists "analytics_analytics_staging"
[0m17:51:18.956139 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:51:18.960536 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: COMMIT
[0m17:51:18.962779 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m17:51:18.964690 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: COMMIT
[0m17:51:18.969191 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:51:18.971110 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: Close
[0m17:51:18.976705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_analytics_staging, now create_demo_analytics_analytics_analytics)
[0m17:51:18.980719 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_analytics_analytics"
"
[0m17:51:18.988786 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m17:51:18.991333 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: BEGIN
[0m17:51:18.993320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:19.006914 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:51:19.010717 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m17:51:19.012739 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_analytics_analytics"} */
create schema if not exists "analytics_analytics_analytics"
[0m17:51:19.016879 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:51:19.020698 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: COMMIT
[0m17:51:19.022635 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m17:51:19.024700 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: COMMIT
[0m17:51:19.028920 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:51:19.030700 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: Close
[0m17:51:19.037420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_analytics_analytics, now list_demo_analytics_analytics_staging)
[0m17:51:19.050582 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m17:51:19.052485 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: BEGIN
[0m17:51:19.054223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:19.067160 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:51:19.069395 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m17:51:19.071146 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m17:51:19.080348 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:51:19.087578 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: ROLLBACK
[0m17:51:19.092939 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: Close
[0m17:51:19.101983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_staging, now list_demo_analytics_analytics_analytics)
[0m17:51:19.114063 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m17:51:19.117389 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: BEGIN
[0m17:51:19.122031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:19.143720 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:51:19.147764 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m17:51:19.152662 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_analytics'
  
[0m17:51:19.166887 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:51:19.173024 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: ROLLBACK
[0m17:51:19.178667 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: Close
[0m17:51:19.201163 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:19.206565 [debug] [MainThread]: On master: BEGIN
[0m17:51:19.210966 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:19.233976 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:51:19.237628 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:19.241544 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:51:19.260210 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:51:19.269213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b298c65-722c-4dd6-afc3-0deecebdb2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf60534e10>]}
[0m17:51:19.274086 [debug] [MainThread]: On master: ROLLBACK
[0m17:51:19.278141 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:19.281775 [debug] [MainThread]: On master: BEGIN
[0m17:51:19.287378 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:51:19.293003 [debug] [MainThread]: On master: COMMIT
[0m17:51:19.297783 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:19.302704 [debug] [MainThread]: On master: COMMIT
[0m17:51:19.306843 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:51:19.312556 [debug] [MainThread]: On master: Close
[0m17:51:19.317277 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:19.321743 [info ] [MainThread]: 
[0m17:51:19.364656 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m17:51:19.370612 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_analytics_staging.stg_transactions ...... [RUN]
[0m17:51:19.376198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_analytics, now model.retail_poc.stg_transactions)
[0m17:51:19.378840 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m17:51:19.404982 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m17:51:19.422496 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 17:51:19.383598 => 17:51:19.421414
[0m17:51:19.424817 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m17:51:19.517470 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m17:51:19.529890 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:51:19.531637 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m17:51:19.533468 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:19.554353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:51:19.559237 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:51:19.562167 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo"."analytics_analytics_staging"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m17:51:27.741338 [debug] [Thread-1 (]: SQL status: SELECT 5000000 in 8.0 seconds
[0m17:51:27.756996 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:51:27.759063 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_analytics_staging"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m17:51:27.761991 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:51:27.829450 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m17:51:27.831902 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:51:27.834023 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m17:51:28.320940 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:51:28.345452 [debug] [Thread-1 (]: Applying DROP to: "demo"."analytics_analytics_staging"."stg_transactions__dbt_backup"
[0m17:51:28.363290 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:51:28.366776 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo"."analytics_analytics_staging"."stg_transactions__dbt_backup" cascade
[0m17:51:28.373832 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:51:28.379124 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 17:51:19.426638 => 17:51:28.378585
[0m17:51:28.381509 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m17:51:28.386177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b298c65-722c-4dd6-afc3-0deecebdb2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf5ea66210>]}
[0m17:51:28.389813 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_analytics_staging.stg_transactions . [[32mSELECT 5000000[0m in 9.01s]
[0m17:51:28.396901 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m17:51:28.404304 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m17:51:28.411476 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics_analytics.fact_orders ......... [RUN]
[0m17:51:28.419280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m17:51:28.427495 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m17:51:28.447315 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m17:51:28.483166 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 17:51:28.430522 => 17:51:28.481977
[0m17:51:28.489620 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m17:51:28.524114 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m17:51:28.566397 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:51:28.570693 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m17:51:28.575656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:51:28.603017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:51:28.607285 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:51:28.610708 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo"."analytics_analytics_analytics"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo"."analytics_analytics_staging"."stg_transactions"
WHERE status = 'completed'   -- optional filter for valid orders
GROUP BY user_id
  );
  
[0m17:51:43.322615 [debug] [Thread-1 (]: SQL status: SELECT 80000 in 15.0 seconds
[0m17:51:43.329720 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:51:43.331691 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics_analytics"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m17:51:43.333930 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:51:43.339843 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m17:51:43.341432 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:51:43.343015 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m17:51:43.364021 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:51:43.370791 [debug] [Thread-1 (]: Applying DROP to: "demo"."analytics_analytics_analytics"."fact_orders__dbt_backup"
[0m17:51:43.373758 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:51:43.375441 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo"."analytics_analytics_analytics"."fact_orders__dbt_backup" cascade
[0m17:51:43.377403 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:51:43.381414 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 17:51:28.492808 => 17:51:43.381029
[0m17:51:43.383033 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m17:51:43.385822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b298c65-722c-4dd6-afc3-0deecebdb2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6026c1d0>]}
[0m17:51:43.388581 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics_analytics.fact_orders .... [[32mSELECT 80000[0m in 14.97s]
[0m17:51:43.391155 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m17:51:43.395689 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:43.397517 [debug] [MainThread]: On master: BEGIN
[0m17:51:43.399138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:51:43.413961 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:51:43.417220 [debug] [MainThread]: On master: COMMIT
[0m17:51:43.421582 [debug] [MainThread]: Using postgres connection "master"
[0m17:51:43.425731 [debug] [MainThread]: On master: COMMIT
[0m17:51:43.428548 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:51:43.430213 [debug] [MainThread]: On master: Close
[0m17:51:43.432698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:43.434970 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m17:51:43.441484 [info ] [MainThread]: 
[0m17:51:43.443817 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 24.64 seconds (24.64s).
[0m17:51:43.447926 [debug] [MainThread]: Command end result
[0m17:51:43.905477 [info ] [MainThread]: 
[0m17:51:43.909020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:43.911462 [info ] [MainThread]: 
[0m17:51:43.914242 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:51:43.918706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 26.832489, "process_user_time": 8.028552, "process_kernel_time": 0.551183, "process_mem_max_rss": "112524", "process_out_blocks": "96", "process_in_blocks": "0"}
[0m17:51:43.921400 [debug] [MainThread]: Command `dbt run` succeeded at 17:51:43.920960 after 26.84 seconds
[0m17:51:43.923481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf65b90790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf65b90810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf65ced050>]}
[0m17:51:43.925368 [debug] [MainThread]: Flushing usage events
[0m17:57:30.032987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff12ad205d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff12b116cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff12ad20e90>]}


============================== 17:57:30.049757 | 98f32815-311a-465d-9c10-84cec6133417 ==============================
[0m17:57:30.049757 [info ] [MainThread]: Running with dbt=1.7.16
[0m17:57:30.052057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:30.055465 [info ] [MainThread]: dbt version: 1.7.16
[0m17:57:30.057088 [info ] [MainThread]: python version: 3.11.2
[0m17:57:30.058579 [info ] [MainThread]: python path: /usr/local/bin/python
[0m17:57:30.060065 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m17:57:30.195979 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m17:57:30.198529 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m17:57:30.200369 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m17:57:30.202473 [info ] [MainThread]: adapter type: postgres
[0m17:57:30.204051 [info ] [MainThread]: adapter version: 1.7.16
[0m17:57:30.358883 [info ] [MainThread]: Configuration:
[0m17:57:30.360929 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:57:30.362834 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:57:30.364692 [info ] [MainThread]: Required dependencies:
[0m17:57:30.366422 [debug] [MainThread]: Executing "git --help"
[0m17:57:30.370273 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:57:30.372164 [debug] [MainThread]: STDERR: "b''"
[0m17:57:30.373767 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:57:30.375623 [info ] [MainThread]: Connection:
[0m17:57:30.377249 [info ] [MainThread]:   host: postgres
[0m17:57:30.378759 [info ] [MainThread]:   port: 5432
[0m17:57:30.380307 [info ] [MainThread]:   user: demo
[0m17:57:30.381843 [info ] [MainThread]:   database: demo
[0m17:57:30.384084 [info ] [MainThread]:   schema: analytics
[0m17:57:30.385836 [info ] [MainThread]:   connect_timeout: 10
[0m17:57:30.387571 [info ] [MainThread]:   role: None
[0m17:57:30.389409 [info ] [MainThread]:   search_path: None
[0m17:57:30.391898 [info ] [MainThread]:   keepalives_idle: 0
[0m17:57:30.393528 [info ] [MainThread]:   sslmode: None
[0m17:57:30.395263 [info ] [MainThread]:   sslcert: None
[0m17:57:30.397446 [info ] [MainThread]:   sslkey: None
[0m17:57:30.399266 [info ] [MainThread]:   sslrootcert: None
[0m17:57:30.400955 [info ] [MainThread]:   application_name: dbt
[0m17:57:30.402621 [info ] [MainThread]:   retries: 1
[0m17:57:30.405314 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m17:57:30.407467 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:57:30.409053 [debug] [MainThread]: Using postgres connection "debug"
[0m17:57:30.410906 [debug] [MainThread]: On debug: select 1 as id
[0m17:57:30.412657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:30.451425 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:57:30.454149 [debug] [MainThread]: On debug: Close
[0m17:57:30.455932 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:57:30.457755 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:57:30.461033 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5268165, "process_user_time": 4.008676, "process_kernel_time": 0.762576, "process_mem_max_rss": "102444", "process_out_blocks": "1216", "process_in_blocks": "0"}
[0m17:57:30.463289 [debug] [MainThread]: Command `dbt debug` succeeded at 17:57:30.463029 after 0.53 seconds
[0m17:57:30.465094 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:57:30.467013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff12b99a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff12ab57f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1294620d0>]}
[0m17:57:30.468905 [debug] [MainThread]: Flushing usage events
[0m17:57:35.404701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44a895810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44a895250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44a8979d0>]}


============================== 17:57:35.410129 | 5f65f312-77fb-4485-a9d8-8a68c1f6a538 ==============================
[0m17:57:35.410129 [info ] [MainThread]: Running with dbt=1.7.16
[0m17:57:35.412344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:35.687057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f65f312-77fb-4485-a9d8-8a68c1f6a538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd448fa7d10>]}
[0m17:57:35.789204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f65f312-77fb-4485-a9d8-8a68c1f6a538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44a6e9b90>]}
[0m17:57:35.791825 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m17:57:35.816852 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m17:57:35.896438 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:57:35.898574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f65f312-77fb-4485-a9d8-8a68c1f6a538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd448db2fd0>]}
[0m17:57:37.749449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f65f312-77fb-4485-a9d8-8a68c1f6a538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44a718dd0>]}
[0m17:57:37.794343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f65f312-77fb-4485-a9d8-8a68c1f6a538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd448c969d0>]}
[0m17:57:37.796398 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:57:37.798005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f65f312-77fb-4485-a9d8-8a68c1f6a538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd448ed5290>]}
[0m17:57:37.805189 [info ] [MainThread]: 
[0m17:57:37.809654 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:57:37.813510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m17:57:37.899022 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m17:57:37.900945 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m17:57:37.902470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:37.918670 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:57:37.922013 [debug] [ThreadPool]: On list_demo: Close
[0m17:57:37.928525 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m17:57:37.930471 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m17:57:37.932093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:37.945697 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:57:37.948829 [debug] [ThreadPool]: On list_demo: Close
[0m17:57:37.952658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_analytics_analytics_staging)
[0m17:57:37.955679 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_analytics_staging"
"
[0m17:57:37.972105 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m17:57:37.975043 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: BEGIN
[0m17:57:37.976967 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:37.994039 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:57:37.995647 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m17:57:37.997012 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_analytics_staging"} */
create schema if not exists "analytics_analytics_staging"
[0m17:57:37.999174 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:57:38.002404 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: COMMIT
[0m17:57:38.004221 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m17:57:38.005870 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: COMMIT
[0m17:57:38.190583 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:57:38.192550 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: Close
[0m17:57:38.196512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_analytics_staging, now create_demo_analytics_analytics_analytics)
[0m17:57:38.199184 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_analytics_analytics"
"
[0m17:57:38.205310 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m17:57:38.207449 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: BEGIN
[0m17:57:38.209316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:38.271706 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:57:38.279930 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m17:57:38.283462 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_analytics_analytics"} */
create schema if not exists "analytics_analytics_analytics"
[0m17:57:38.290919 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m17:57:38.299654 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: COMMIT
[0m17:57:38.302804 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m17:57:38.305055 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: COMMIT
[0m17:57:38.436746 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m17:57:38.438589 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: Close
[0m17:57:38.443278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_analytics_analytics, now list_demo_analytics_analytics_staging)
[0m17:57:38.456879 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m17:57:38.459248 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: BEGIN
[0m17:57:38.461288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:38.475543 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:57:38.477500 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m17:57:38.479184 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m17:57:38.485704 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:57:38.489137 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: ROLLBACK
[0m17:57:38.491268 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: Close
[0m17:57:38.495437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_staging, now list_demo_analytics_analytics_analytics)
[0m17:57:38.502601 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m17:57:38.504886 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: BEGIN
[0m17:57:38.506717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:38.519704 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:57:38.521676 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m17:57:38.523294 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_analytics'
  
[0m17:57:38.529026 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m17:57:38.533671 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: ROLLBACK
[0m17:57:38.537360 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: Close
[0m17:57:38.552855 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:38.554907 [debug] [MainThread]: On master: BEGIN
[0m17:57:38.556593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:38.569950 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:57:38.571951 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:38.573964 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:57:38.582520 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:57:38.585698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f65f312-77fb-4485-a9d8-8a68c1f6a538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd448eddf90>]}
[0m17:57:38.587403 [debug] [MainThread]: On master: ROLLBACK
[0m17:57:38.589002 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:38.590534 [debug] [MainThread]: On master: BEGIN
[0m17:57:38.592740 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:57:38.594296 [debug] [MainThread]: On master: COMMIT
[0m17:57:38.595549 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:38.596753 [debug] [MainThread]: On master: COMMIT
[0m17:57:38.598364 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:57:38.599721 [debug] [MainThread]: On master: Close
[0m17:57:38.601886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:38.603587 [info ] [MainThread]: 
[0m17:57:38.617811 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m17:57:38.619941 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_analytics_staging.stg_transactions ...... [RUN]
[0m17:57:38.622393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_analytics, now model.retail_poc.stg_transactions)
[0m17:57:38.624126 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m17:57:38.637601 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m17:57:38.650259 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 17:57:38.625425 => 17:57:38.649703
[0m17:57:38.651884 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m17:57:38.748546 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m17:57:38.760348 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:57:38.762030 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m17:57:38.763639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:38.776290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:57:38.778316 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:57:38.779879 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo"."analytics_analytics_staging"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m17:57:39.193732 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m17:57:39.206273 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:57:39.208304 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_analytics_staging"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m17:57:39.211860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:57:39.251915 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m17:57:39.254207 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:57:39.255807 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m17:57:39.312210 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:57:39.325807 [debug] [Thread-1 (]: Applying DROP to: "demo"."analytics_analytics_staging"."stg_transactions__dbt_backup"
[0m17:57:39.337319 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:57:39.339225 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo"."analytics_analytics_staging"."stg_transactions__dbt_backup" cascade
[0m17:57:39.341587 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:57:39.345378 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 17:57:38.653170 => 17:57:39.344947
[0m17:57:39.347233 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m17:57:39.350857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f65f312-77fb-4485-a9d8-8a68c1f6a538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd448cbfcd0>]}
[0m17:57:39.353151 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_analytics_staging.stg_transactions . [[32mSELECT 0[0m in 0.73s]
[0m17:57:39.355473 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m17:57:39.358521 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m17:57:39.360174 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics_analytics.fact_orders ......... [RUN]
[0m17:57:39.362543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m17:57:39.364347 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m17:57:39.370654 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m17:57:39.383674 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 17:57:39.365746 => 17:57:39.382578
[0m17:57:39.385788 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m17:57:39.396068 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m17:57:39.409479 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:57:39.412244 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m17:57:39.414087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:39.429321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:57:39.431414 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:57:39.433354 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo"."analytics_analytics_analytics"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo"."analytics_analytics_staging"."stg_transactions"
WHERE status = 'completed'   -- optional filter for valid orders
GROUP BY user_id
  );
  
[0m17:57:39.443226 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m17:57:39.453908 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:57:39.456001 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics_analytics"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m17:57:39.458416 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:57:39.463727 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m17:57:39.465642 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:57:39.467679 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m17:57:39.471890 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:57:39.478534 [debug] [Thread-1 (]: Applying DROP to: "demo"."analytics_analytics_analytics"."fact_orders__dbt_backup"
[0m17:57:39.481923 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:57:39.483735 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo"."analytics_analytics_analytics"."fact_orders__dbt_backup" cascade
[0m17:57:39.486147 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:57:39.490085 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 17:57:39.387258 => 17:57:39.489685
[0m17:57:39.491825 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m17:57:39.494808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f65f312-77fb-4485-a9d8-8a68c1f6a538', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd448d0e550>]}
[0m17:57:39.497114 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics_analytics.fact_orders .... [[32mSELECT 0[0m in 0.13s]
[0m17:57:39.499362 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m17:57:39.504420 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:39.506207 [debug] [MainThread]: On master: BEGIN
[0m17:57:39.508056 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:39.523132 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:57:39.525399 [debug] [MainThread]: On master: COMMIT
[0m17:57:39.526923 [debug] [MainThread]: Using postgres connection "master"
[0m17:57:39.528513 [debug] [MainThread]: On master: COMMIT
[0m17:57:39.530613 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:57:39.532466 [debug] [MainThread]: On master: Close
[0m17:57:39.534982 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:39.536614 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m17:57:39.538387 [info ] [MainThread]: 
[0m17:57:39.540233 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m17:57:39.544692 [debug] [MainThread]: Command end result
[0m17:57:39.577664 [info ] [MainThread]: 
[0m17:57:39.580160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:39.581932 [info ] [MainThread]: 
[0m17:57:39.584096 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:57:39.586709 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3029995, "process_user_time": 6.521593, "process_kernel_time": 0.151196, "process_mem_max_rss": "113592", "process_out_blocks": "96", "process_in_blocks": "0"}
[0m17:57:39.589157 [debug] [MainThread]: Command `dbt run` succeeded at 17:57:39.588744 after 4.31 seconds
[0m17:57:39.591333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44a6c7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44a6f4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd44e6a2c50>]}
[0m17:57:39.593702 [debug] [MainThread]: Flushing usage events
[0m17:58:48.741899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70b8f4bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70bef7150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70b8f7d90>]}


============================== 17:58:48.746888 | b925d1c3-3e7c-4893-a1fd-46d17bc2d97a ==============================
[0m17:58:48.746888 [info ] [MainThread]: Running with dbt=1.7.16
[0m17:58:48.748992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:58:48.752776 [info ] [MainThread]: dbt version: 1.7.16
[0m17:58:48.754364 [info ] [MainThread]: python version: 3.11.2
[0m17:58:48.755847 [info ] [MainThread]: python path: /usr/local/bin/python
[0m17:58:48.757425 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m17:58:48.916809 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m17:58:48.920132 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m17:58:48.921934 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m17:58:48.924615 [info ] [MainThread]: adapter type: postgres
[0m17:58:48.926470 [info ] [MainThread]: adapter version: 1.7.16
[0m17:58:49.087900 [info ] [MainThread]: Configuration:
[0m17:58:49.089840 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:58:49.091647 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:58:49.093459 [info ] [MainThread]: Required dependencies:
[0m17:58:49.094996 [debug] [MainThread]: Executing "git --help"
[0m17:58:49.098773 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:58:49.100621 [debug] [MainThread]: STDERR: "b''"
[0m17:58:49.101998 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:58:49.103486 [info ] [MainThread]: Connection:
[0m17:58:49.105210 [info ] [MainThread]:   host: postgres
[0m17:58:49.107107 [info ] [MainThread]:   port: 5432
[0m17:58:49.108753 [info ] [MainThread]:   user: demo
[0m17:58:49.110498 [info ] [MainThread]:   database: demo
[0m17:58:49.112275 [info ] [MainThread]:   schema: analytics
[0m17:58:49.113987 [info ] [MainThread]:   connect_timeout: 10
[0m17:58:49.116119 [info ] [MainThread]:   role: None
[0m17:58:49.117869 [info ] [MainThread]:   search_path: None
[0m17:58:49.119523 [info ] [MainThread]:   keepalives_idle: 0
[0m17:58:49.121003 [info ] [MainThread]:   sslmode: None
[0m17:58:49.122533 [info ] [MainThread]:   sslcert: None
[0m17:58:49.124006 [info ] [MainThread]:   sslkey: None
[0m17:58:49.125445 [info ] [MainThread]:   sslrootcert: None
[0m17:58:49.126973 [info ] [MainThread]:   application_name: dbt
[0m17:58:49.128446 [info ] [MainThread]:   retries: 1
[0m17:58:49.130389 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m17:58:49.132614 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:58:49.134302 [debug] [MainThread]: Using postgres connection "debug"
[0m17:58:49.135841 [debug] [MainThread]: On debug: select 1 as id
[0m17:58:49.137427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:49.153946 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m17:58:49.156660 [debug] [MainThread]: On debug: Close
[0m17:58:49.158102 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:58:49.160220 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:58:49.162964 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5382599, "process_user_time": 4.214863, "process_kernel_time": 0.218695, "process_mem_max_rss": "102320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:58:49.165007 [debug] [MainThread]: Command `dbt debug` succeeded at 17:58:49.164767 after 0.54 seconds
[0m17:58:49.166737 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:58:49.168274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70b747b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70b747750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70a05b890>]}
[0m17:58:49.170313 [debug] [MainThread]: Flushing usage events
[0m17:58:53.767065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030dbce350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030e2667d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030e0354d0>]}


============================== 17:58:53.772141 | a1a1346b-65f2-4fc3-aebb-8b7fb1fbf551 ==============================
[0m17:58:53.772141 [info ] [MainThread]: Running with dbt=1.7.16
[0m17:58:53.774175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m17:58:54.053725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1a1346b-65f2-4fc3-aebb-8b7fb1fbf551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030dbb7090>]}
[0m17:58:54.173753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1a1346b-65f2-4fc3-aebb-8b7fb1fbf551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030c2df550>]}
[0m17:58:54.176571 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m17:58:54.202964 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m17:58:54.371701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:54.373540 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:54.392121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1a1346b-65f2-4fc3-aebb-8b7fb1fbf551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030db9a350>]}
[0m17:58:54.442937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1a1346b-65f2-4fc3-aebb-8b7fb1fbf551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030c1d8b10>]}
[0m17:58:54.445349 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m17:58:54.448755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a1346b-65f2-4fc3-aebb-8b7fb1fbf551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030c1c8150>]}
[0m17:58:54.454012 [info ] [MainThread]: 
[0m17:58:54.458152 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:58:54.463461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m17:58:54.487314 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m17:58:54.489262 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m17:58:54.490766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:54.505960 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:58:54.510367 [debug] [ThreadPool]: On list_demo: Close
[0m17:58:54.518309 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m17:58:54.520123 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m17:58:54.521717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:54.536763 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m17:58:54.540566 [debug] [ThreadPool]: On list_demo: Close
[0m17:58:54.545323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now list_demo_analytics_analytics_staging)
[0m17:58:54.557248 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m17:58:54.559081 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: BEGIN
[0m17:58:54.560467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:54.572797 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:58:54.574532 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m17:58:54.576068 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m17:58:54.581449 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:58:54.584666 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: ROLLBACK
[0m17:58:54.586445 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: Close
[0m17:58:54.589358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_staging, now list_demo_analytics_analytics_analytics)
[0m17:58:54.594585 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m17:58:54.596354 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: BEGIN
[0m17:58:54.597787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:54.610415 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:58:54.612593 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m17:58:54.614433 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_analytics'
  
[0m17:58:54.619981 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:58:54.623267 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: ROLLBACK
[0m17:58:54.625420 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: Close
[0m17:58:54.635061 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:54.636846 [debug] [MainThread]: On master: BEGIN
[0m17:58:54.638470 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:54.650982 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:54.652668 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:54.654273 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:58:54.660568 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:58:54.663845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1a1346b-65f2-4fc3-aebb-8b7fb1fbf551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030db76950>]}
[0m17:58:54.665482 [debug] [MainThread]: On master: ROLLBACK
[0m17:58:54.667097 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:54.668452 [debug] [MainThread]: On master: BEGIN
[0m17:58:54.670312 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:54.671722 [debug] [MainThread]: On master: COMMIT
[0m17:58:54.673227 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:54.674590 [debug] [MainThread]: On master: COMMIT
[0m17:58:54.676179 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:58:54.677522 [debug] [MainThread]: On master: Close
[0m17:58:54.679590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:54.681135 [info ] [MainThread]: 
[0m17:58:54.685362 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m17:58:54.687151 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_analytics_staging.stg_transactions ...... [RUN]
[0m17:58:54.689331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_analytics, now model.retail_poc.stg_transactions)
[0m17:58:54.690759 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m17:58:54.704304 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m17:58:54.717821 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 17:58:54.691964 => 17:58:54.717061
[0m17:58:54.719676 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m17:58:54.795740 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m17:58:54.809891 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:58:54.811584 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m17:58:54.813072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:54.825561 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:58:54.827480 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:58:54.829048 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo"."analytics_analytics_staging"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m17:58:55.861390 [debug] [Thread-1 (]: SQL status: SELECT 500000 in 1.0 seconds
[0m17:58:55.878795 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:58:55.881539 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_analytics_staging"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m17:58:55.884400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:58:55.891292 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:58:55.893389 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_analytics_staging"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m17:58:55.895904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:58:55.941210 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m17:58:55.943552 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:58:55.945521 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m17:58:55.953261 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:58:55.968919 [debug] [Thread-1 (]: Applying DROP to: "demo"."analytics_analytics_staging"."stg_transactions__dbt_backup"
[0m17:58:55.981560 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m17:58:55.983935 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo"."analytics_analytics_staging"."stg_transactions__dbt_backup" cascade
[0m17:58:55.990030 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:58:55.994220 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 17:58:54.720936 => 17:58:55.993845
[0m17:58:55.996023 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m17:58:55.998587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a1346b-65f2-4fc3-aebb-8b7fb1fbf551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030bfbd910>]}
[0m17:58:56.000541 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_analytics_staging.stg_transactions . [[32mSELECT 500000[0m in 1.31s]
[0m17:58:56.002572 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m17:58:56.005452 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m17:58:56.007206 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics_analytics.fact_orders ......... [RUN]
[0m17:58:56.009407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m17:58:56.010838 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m17:58:56.017004 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m17:58:56.029397 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 17:58:56.011999 => 17:58:56.028749
[0m17:58:56.031018 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m17:58:56.039935 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m17:58:56.052534 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:58:56.054029 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m17:58:56.055503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:58:56.067583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:58:56.069862 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:58:56.071893 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo"."analytics_analytics_analytics"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo"."analytics_analytics_staging"."stg_transactions"
WHERE status = 'completed'   -- optional filter for valid orders
GROUP BY user_id
  );
  
[0m17:58:57.752102 [debug] [Thread-1 (]: SQL status: SELECT 79791 in 2.0 seconds
[0m17:58:57.759191 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:58:57.761203 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics_analytics"."fact_orders" rename to "fact_orders__dbt_backup"
[0m17:58:57.763824 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:58:57.770399 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:58:57.772355 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics_analytics"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m17:58:57.774760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:58:57.779809 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m17:58:57.781720 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:58:57.783688 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m17:58:57.790984 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:58:57.796908 [debug] [Thread-1 (]: Applying DROP to: "demo"."analytics_analytics_analytics"."fact_orders__dbt_backup"
[0m17:58:57.799778 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m17:58:57.801834 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo"."analytics_analytics_analytics"."fact_orders__dbt_backup" cascade
[0m17:58:57.806918 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:58:57.811324 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 17:58:56.032283 => 17:58:57.810822
[0m17:58:57.813217 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m17:58:57.815853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1a1346b-65f2-4fc3-aebb-8b7fb1fbf551', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030bfb75d0>]}
[0m17:58:57.818062 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics_analytics.fact_orders .... [[32mSELECT 79791[0m in 1.81s]
[0m17:58:57.820481 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m17:58:57.824469 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:57.826094 [debug] [MainThread]: On master: BEGIN
[0m17:58:57.827540 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:57.840054 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:57.842014 [debug] [MainThread]: On master: COMMIT
[0m17:58:57.843634 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:57.844988 [debug] [MainThread]: On master: COMMIT
[0m17:58:57.846899 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:58:57.849580 [debug] [MainThread]: On master: Close
[0m17:58:57.852324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:57.854027 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m17:58:57.855920 [info ] [MainThread]: 
[0m17:58:57.857626 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m17:58:57.860090 [debug] [MainThread]: Command end result
[0m17:58:57.895764 [info ] [MainThread]: 
[0m17:58:57.897453 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:57.898923 [info ] [MainThread]: 
[0m17:58:57.900595 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:58:57.902988 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.2311935, "process_user_time": 4.439628, "process_kernel_time": 0.159627, "process_mem_max_rss": "108888", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:58:57.904721 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:57.904490 after 4.23 seconds
[0m17:58:57.906110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030dbd3a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030dbd3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f030c215d90>]}
[0m17:58:57.907687 [debug] [MainThread]: Flushing usage events
[0m18:00:14.220938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8257be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd82c09d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd82fa6950>]}


============================== 18:00:14.231385 | b6d44024-d7c3-4c78-8b96-f5e64ae3a452 ==============================
[0m18:00:14.231385 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:00:14.234532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:14.237919 [info ] [MainThread]: dbt version: 1.7.16
[0m18:00:14.239754 [info ] [MainThread]: python version: 3.11.2
[0m18:00:14.241490 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:00:14.243031 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m18:00:14.397731 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:00:14.399605 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:00:14.401326 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:00:14.404488 [info ] [MainThread]: adapter type: postgres
[0m18:00:14.406426 [info ] [MainThread]: adapter version: 1.7.16
[0m18:00:14.591342 [info ] [MainThread]: Configuration:
[0m18:00:14.593505 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:00:14.595380 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:00:14.597702 [info ] [MainThread]: Required dependencies:
[0m18:00:14.599302 [debug] [MainThread]: Executing "git --help"
[0m18:00:14.603551 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:00:14.605308 [debug] [MainThread]: STDERR: "b''"
[0m18:00:14.607037 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:00:14.608837 [info ] [MainThread]: Connection:
[0m18:00:14.611065 [info ] [MainThread]:   host: postgres
[0m18:00:14.612587 [info ] [MainThread]:   port: 5432
[0m18:00:14.614113 [info ] [MainThread]:   user: demo
[0m18:00:14.615775 [info ] [MainThread]:   database: demo
[0m18:00:14.617296 [info ] [MainThread]:   schema: analytics
[0m18:00:14.618819 [info ] [MainThread]:   connect_timeout: 10
[0m18:00:14.620436 [info ] [MainThread]:   role: None
[0m18:00:14.622236 [info ] [MainThread]:   search_path: None
[0m18:00:14.623937 [info ] [MainThread]:   keepalives_idle: 0
[0m18:00:14.625514 [info ] [MainThread]:   sslmode: None
[0m18:00:14.627051 [info ] [MainThread]:   sslcert: None
[0m18:00:14.628523 [info ] [MainThread]:   sslkey: None
[0m18:00:14.630411 [info ] [MainThread]:   sslrootcert: None
[0m18:00:14.632960 [info ] [MainThread]:   application_name: dbt
[0m18:00:14.634585 [info ] [MainThread]:   retries: 1
[0m18:00:14.636542 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m18:00:14.638928 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:00:14.640493 [debug] [MainThread]: Using postgres connection "debug"
[0m18:00:14.642117 [debug] [MainThread]: On debug: select 1 as id
[0m18:00:14.646375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:14.663322 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:14.667027 [debug] [MainThread]: On debug: Close
[0m18:00:14.669046 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:00:14.671100 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:00:14.673350 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.54831827, "process_user_time": 4.351214, "process_kernel_time": 0.232199, "process_mem_max_rss": "102396", "process_out_blocks": "1216", "process_in_blocks": "0"}
[0m18:00:14.675252 [debug] [MainThread]: Command `dbt debug` succeeded at 18:00:14.675018 after 0.55 seconds
[0m18:00:14.676641 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:00:14.678111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd82c0a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8494d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd80edb750>]}
[0m18:00:14.679760 [debug] [MainThread]: Flushing usage events
[0m18:00:19.649802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2e8b78d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2ed4da10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2fbf6390>]}


============================== 18:00:19.660532 | ac91e6d0-e668-45bc-ae34-85d7249ad2b5 ==============================
[0m18:00:19.660532 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:00:19.663754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:00:19.999046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac91e6d0-e668-45bc-ae34-85d7249ad2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2d01f150>]}
[0m18:00:20.134250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac91e6d0-e668-45bc-ae34-85d7249ad2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2cfd31d0>]}
[0m18:00:20.136966 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m18:00:20.162184 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m18:00:20.307109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:00:20.309094 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:00:20.320400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac91e6d0-e668-45bc-ae34-85d7249ad2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2cf50150>]}
[0m18:00:20.359342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac91e6d0-e668-45bc-ae34-85d7249ad2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2cee4990>]}
[0m18:00:20.361250 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:00:20.363044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac91e6d0-e668-45bc-ae34-85d7249ad2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2ced0c90>]}
[0m18:00:20.367025 [info ] [MainThread]: 
[0m18:00:20.369971 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:00:20.373443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m18:00:20.396528 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m18:00:20.399738 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:00:20.401731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:20.418913 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:00:20.422389 [debug] [ThreadPool]: On list_demo: Close
[0m18:00:20.428640 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m18:00:20.430648 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:00:20.432346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:20.445432 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:00:20.449261 [debug] [ThreadPool]: On list_demo: Close
[0m18:00:20.453644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now list_demo_analytics_analytics_analytics)
[0m18:00:20.464925 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m18:00:20.466753 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: BEGIN
[0m18:00:20.468318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:20.481278 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:00:20.483229 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m18:00:20.485183 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_analytics'
  
[0m18:00:20.490846 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:20.493973 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: ROLLBACK
[0m18:00:20.495815 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: Close
[0m18:00:20.498938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_analytics, now list_demo_analytics_analytics_staging)
[0m18:00:20.504070 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m18:00:20.505739 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: BEGIN
[0m18:00:20.507288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:20.519639 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:00:20.521640 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m18:00:20.523424 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m18:00:20.528837 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:00:20.532547 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: ROLLBACK
[0m18:00:20.536141 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: Close
[0m18:00:20.547691 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:20.550416 [debug] [MainThread]: On master: BEGIN
[0m18:00:20.552188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:00:20.565980 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:00:20.568176 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:20.569962 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:00:20.576481 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:00:20.580159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac91e6d0-e668-45bc-ae34-85d7249ad2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2e8b5290>]}
[0m18:00:20.582068 [debug] [MainThread]: On master: ROLLBACK
[0m18:00:20.584129 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:20.585808 [debug] [MainThread]: On master: BEGIN
[0m18:00:20.587835 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:00:20.589339 [debug] [MainThread]: On master: COMMIT
[0m18:00:20.590804 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:20.592145 [debug] [MainThread]: On master: COMMIT
[0m18:00:20.593734 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:00:20.595125 [debug] [MainThread]: On master: Close
[0m18:00:20.597304 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:20.598820 [info ] [MainThread]: 
[0m18:00:20.612157 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m18:00:20.614478 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_analytics_staging.stg_transactions ...... [RUN]
[0m18:00:20.617235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_staging, now model.retail_poc.stg_transactions)
[0m18:00:20.619163 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m18:00:20.633278 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m18:00:20.648016 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 18:00:20.620831 => 18:00:20.647511
[0m18:00:20.649693 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m18:00:20.731469 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m18:00:20.745263 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:00:20.746971 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m18:00:20.748472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:20.761064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:20.763111 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:00:20.764754 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo"."analytics_analytics_staging"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m18:00:21.976660 [debug] [Thread-1 (]: SQL status: SELECT 1000000 in 1.0 seconds
[0m18:00:21.988819 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:00:21.990917 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_analytics_staging"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m18:00:21.993290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:21.999964 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:00:22.001835 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_analytics_staging"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m18:00:22.004268 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:22.040394 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m18:00:22.042468 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:00:22.044299 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m18:00:22.056720 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:00:22.071350 [debug] [Thread-1 (]: Applying DROP to: "demo"."analytics_analytics_staging"."stg_transactions__dbt_backup"
[0m18:00:22.082124 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:00:22.084370 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo"."analytics_analytics_staging"."stg_transactions__dbt_backup" cascade
[0m18:00:22.097013 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:00:22.101353 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 18:00:20.650965 => 18:00:22.100967
[0m18:00:22.103300 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m18:00:22.105910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac91e6d0-e668-45bc-ae34-85d7249ad2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2ce627d0>]}
[0m18:00:22.108162 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_analytics_staging.stg_transactions . [[32mSELECT 1000000[0m in 1.49s]
[0m18:00:22.110445 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m18:00:22.113362 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m18:00:22.115218 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics_analytics.fact_orders ......... [RUN]
[0m18:00:22.117885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m18:00:22.119582 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m18:00:22.125821 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m18:00:22.139046 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 18:00:22.120819 => 18:00:22.138517
[0m18:00:22.140591 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m18:00:22.149792 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m18:00:22.161768 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:00:22.163356 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m18:00:22.164885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:22.176965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:00:22.179044 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:00:22.180955 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo"."analytics_analytics_analytics"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo"."analytics_analytics_staging"."stg_transactions"
WHERE status = 'completed'   -- optional filter for valid orders
GROUP BY user_id
  );
  
[0m18:00:24.982651 [debug] [Thread-1 (]: SQL status: SELECT 79999 in 3.0 seconds
[0m18:00:24.989649 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:00:24.991573 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics_analytics"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:00:24.993721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:25.000306 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:00:25.002072 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics_analytics"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:00:25.004430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:00:25.009568 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m18:00:25.011311 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:00:25.013116 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m18:00:25.034549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:00:25.041004 [debug] [Thread-1 (]: Applying DROP to: "demo"."analytics_analytics_analytics"."fact_orders__dbt_backup"
[0m18:00:25.043868 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:00:25.045920 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo"."analytics_analytics_analytics"."fact_orders__dbt_backup" cascade
[0m18:00:25.051726 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:00:25.055546 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 18:00:22.141879 => 18:00:25.055180
[0m18:00:25.057359 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m18:00:25.059824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac91e6d0-e668-45bc-ae34-85d7249ad2b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2ccd1510>]}
[0m18:00:25.061910 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics_analytics.fact_orders .... [[32mSELECT 79999[0m in 2.94s]
[0m18:00:25.064297 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m18:00:25.068052 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:25.069536 [debug] [MainThread]: On master: BEGIN
[0m18:00:25.070872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:00:25.084432 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:00:25.086000 [debug] [MainThread]: On master: COMMIT
[0m18:00:25.087501 [debug] [MainThread]: Using postgres connection "master"
[0m18:00:25.089340 [debug] [MainThread]: On master: COMMIT
[0m18:00:25.091641 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:00:25.093349 [debug] [MainThread]: On master: Close
[0m18:00:25.095894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:25.097740 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m18:00:25.099727 [info ] [MainThread]: 
[0m18:00:25.101915 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m18:00:25.105032 [debug] [MainThread]: Command end result
[0m18:00:25.144092 [info ] [MainThread]: 
[0m18:00:25.147091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:25.149912 [info ] [MainThread]: 
[0m18:00:25.151987 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:00:25.157455 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6246667, "process_user_time": 4.705899, "process_kernel_time": 0.222166, "process_mem_max_rss": "110576", "process_out_blocks": "96", "process_in_blocks": "0"}
[0m18:00:25.160476 [debug] [MainThread]: Command `dbt run` succeeded at 18:00:25.159667 after 5.63 seconds
[0m18:00:25.164305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca2f212610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca32700810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca32700890>]}
[0m18:00:25.167688 [debug] [MainThread]: Flushing usage events
[0m18:02:14.438232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ad6b2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76add41950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76adcaee50>]}


============================== 18:02:14.448956 | 0b6773b0-d2a8-4fd3-9f96-f16d6276bb25 ==============================
[0m18:02:14.448956 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:02:14.450875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:02:14.453843 [info ] [MainThread]: dbt version: 1.7.16
[0m18:02:14.455664 [info ] [MainThread]: python version: 3.11.2
[0m18:02:14.457207 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:02:14.458668 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m18:02:14.598721 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:02:14.600843 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:02:14.602905 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:02:14.604756 [info ] [MainThread]: adapter type: postgres
[0m18:02:14.606340 [info ] [MainThread]: adapter version: 1.7.16
[0m18:02:14.757947 [info ] [MainThread]: Configuration:
[0m18:02:14.760230 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:02:14.762247 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:02:14.766062 [info ] [MainThread]: Required dependencies:
[0m18:02:14.768469 [debug] [MainThread]: Executing "git --help"
[0m18:02:14.773346 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:02:14.776023 [debug] [MainThread]: STDERR: "b''"
[0m18:02:14.777990 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:02:14.780607 [info ] [MainThread]: Connection:
[0m18:02:14.784217 [info ] [MainThread]:   host: postgres
[0m18:02:14.790591 [info ] [MainThread]:   port: 5432
[0m18:02:14.794058 [info ] [MainThread]:   user: demo
[0m18:02:14.798211 [info ] [MainThread]:   database: demo
[0m18:02:14.800468 [info ] [MainThread]:   schema: analytics
[0m18:02:14.803336 [info ] [MainThread]:   connect_timeout: 10
[0m18:02:14.805484 [info ] [MainThread]:   role: None
[0m18:02:14.807697 [info ] [MainThread]:   search_path: None
[0m18:02:14.811147 [info ] [MainThread]:   keepalives_idle: 0
[0m18:02:14.813355 [info ] [MainThread]:   sslmode: None
[0m18:02:14.815779 [info ] [MainThread]:   sslcert: None
[0m18:02:14.818475 [info ] [MainThread]:   sslkey: None
[0m18:02:14.822056 [info ] [MainThread]:   sslrootcert: None
[0m18:02:14.825692 [info ] [MainThread]:   application_name: dbt
[0m18:02:14.828732 [info ] [MainThread]:   retries: 1
[0m18:02:14.831679 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m18:02:14.835839 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:02:14.839382 [debug] [MainThread]: Using postgres connection "debug"
[0m18:02:14.842391 [debug] [MainThread]: On debug: select 1 as id
[0m18:02:14.844923 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:14.866555 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m18:02:14.869742 [debug] [MainThread]: On debug: Close
[0m18:02:14.871868 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:02:14.873839 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:02:14.877379 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.53977287, "process_user_time": 4.176659, "process_kernel_time": 0.261041, "process_mem_max_rss": "102708", "process_out_blocks": "1216", "process_in_blocks": "0"}
[0m18:02:14.880634 [debug] [MainThread]: Command `dbt debug` succeeded at 18:02:14.880351 after 0.54 seconds
[0m18:02:14.882179 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:02:14.883792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76adcaee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ad6ebf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76ac0132d0>]}
[0m18:02:14.885674 [debug] [MainThread]: Flushing usage events
[0m18:02:19.663776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb485b52d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb485b4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb485e8fd0>]}


============================== 18:02:19.669324 | a0351977-452f-4f66-a233-6901425c6fd1 ==============================
[0m18:02:19.669324 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:02:19.671534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:02:19.955145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0351977-452f-4f66-a233-6901425c6fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb46ce56d0>]}
[0m18:02:20.065021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0351977-452f-4f66-a233-6901425c6fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb48599b10>]}
[0m18:02:20.067592 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m18:02:20.093438 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m18:02:20.119277 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:02:20.121438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a0351977-452f-4f66-a233-6901425c6fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb46caedd0>]}
[0m18:02:21.933563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0351977-452f-4f66-a233-6901425c6fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb46d3a450>]}
[0m18:02:21.975862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0351977-452f-4f66-a233-6901425c6fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb46ba66d0>]}
[0m18:02:21.978047 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:02:21.980076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0351977-452f-4f66-a233-6901425c6fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4b3ad6d0>]}
[0m18:02:21.984596 [info ] [MainThread]: 
[0m18:02:21.987362 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:02:21.990591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m18:02:22.070646 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m18:02:22.072336 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:02:22.073981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:22.088759 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:02:22.092206 [debug] [ThreadPool]: On list_demo: Close
[0m18:02:22.098398 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m18:02:22.100106 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:02:22.101431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:22.113981 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:02:22.117355 [debug] [ThreadPool]: On list_demo: Close
[0m18:02:22.121585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now list_demo_analytics_analytics_analytics)
[0m18:02:22.133990 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m18:02:22.135872 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: BEGIN
[0m18:02:22.137935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:22.151523 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:02:22.153590 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m18:02:22.155351 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_analytics'
  
[0m18:02:22.160525 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:02:22.163546 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: ROLLBACK
[0m18:02:22.165261 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: Close
[0m18:02:22.168218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_analytics, now list_demo_analytics_analytics_staging)
[0m18:02:22.173241 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m18:02:22.174804 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: BEGIN
[0m18:02:22.176355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:22.188563 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:02:22.190688 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m18:02:22.192651 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m18:02:22.197912 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:02:22.201020 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: ROLLBACK
[0m18:02:22.203133 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: Close
[0m18:02:22.213066 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:22.215050 [debug] [MainThread]: On master: BEGIN
[0m18:02:22.216989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:02:22.229404 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:02:22.231326 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:22.233042 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:02:22.239844 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:02:22.242859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0351977-452f-4f66-a233-6901425c6fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb484c4e10>]}
[0m18:02:22.244651 [debug] [MainThread]: On master: ROLLBACK
[0m18:02:22.246520 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:22.248003 [debug] [MainThread]: On master: BEGIN
[0m18:02:22.249987 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:02:22.251572 [debug] [MainThread]: On master: COMMIT
[0m18:02:22.253069 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:22.254511 [debug] [MainThread]: On master: COMMIT
[0m18:02:22.256214 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:02:22.257751 [debug] [MainThread]: On master: Close
[0m18:02:22.259851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:22.261399 [info ] [MainThread]: 
[0m18:02:22.276076 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m18:02:22.278253 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_analytics_staging.stg_transactions ...... [RUN]
[0m18:02:22.280772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_staging, now model.retail_poc.stg_transactions)
[0m18:02:22.282363 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m18:02:22.297123 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m18:02:22.309997 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 18:02:22.283932 => 18:02:22.309352
[0m18:02:22.311789 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m18:02:22.401489 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m18:02:22.413481 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:02:22.415150 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m18:02:22.416668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:22.428725 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:02:22.430620 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:02:22.432122 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo"."analytics_analytics_staging"."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m18:02:24.134427 [debug] [Thread-1 (]: SQL status: SELECT 1500000 in 2.0 seconds
[0m18:02:24.146486 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:02:24.148574 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_analytics_staging"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m18:02:24.150733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:02:24.157340 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:02:24.159298 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_analytics_staging"."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m18:02:24.161723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:02:24.217254 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m18:02:24.220591 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:02:24.222518 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m18:02:24.243448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:02:24.264869 [debug] [Thread-1 (]: Applying DROP to: "demo"."analytics_analytics_staging"."stg_transactions__dbt_backup"
[0m18:02:24.276645 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:02:24.278614 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo"."analytics_analytics_staging"."stg_transactions__dbt_backup" cascade
[0m18:02:24.301337 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:02:24.313351 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 18:02:22.313080 => 18:02:24.312908
[0m18:02:24.315364 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m18:02:24.317944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0351977-452f-4f66-a233-6901425c6fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4523bd90>]}
[0m18:02:24.320265 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_analytics_staging.stg_transactions . [[32mSELECT 1500000[0m in 2.04s]
[0m18:02:24.322493 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m18:02:24.325296 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m18:02:24.327061 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics_analytics.fact_orders ......... [RUN]
[0m18:02:24.329217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m18:02:24.330718 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m18:02:24.336906 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m18:02:24.348610 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 18:02:24.331957 => 18:02:24.347947
[0m18:02:24.350236 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m18:02:24.359854 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m18:02:24.373292 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:02:24.374919 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m18:02:24.376447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:24.389429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:02:24.391503 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:02:24.394164 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo"."analytics_analytics_analytics"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo"."analytics_analytics_staging"."stg_transactions"
WHERE status = 'completed'   -- optional filter for valid orders
GROUP BY user_id
  );
  
[0m18:02:28.476816 [debug] [Thread-1 (]: SQL status: SELECT 80000 in 4.0 seconds
[0m18:02:28.484162 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:02:28.486059 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics_analytics"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:02:28.488474 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:02:28.494741 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:02:28.496555 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics_analytics"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:02:28.498777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:02:28.503948 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m18:02:28.505687 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:02:28.507210 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m18:02:28.512457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:02:28.518239 [debug] [Thread-1 (]: Applying DROP to: "demo"."analytics_analytics_analytics"."fact_orders__dbt_backup"
[0m18:02:28.520864 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:02:28.522591 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo"."analytics_analytics_analytics"."fact_orders__dbt_backup" cascade
[0m18:02:28.528566 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:02:28.532286 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 18:02:24.351695 => 18:02:28.531724
[0m18:02:28.533847 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m18:02:28.536084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0351977-452f-4f66-a233-6901425c6fd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4523ecd0>]}
[0m18:02:28.537912 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics_analytics.fact_orders .... [[32mSELECT 80000[0m in 4.21s]
[0m18:02:28.539876 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m18:02:28.543681 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:28.545189 [debug] [MainThread]: On master: BEGIN
[0m18:02:28.546458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:02:28.558846 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:02:28.560527 [debug] [MainThread]: On master: COMMIT
[0m18:02:28.561941 [debug] [MainThread]: Using postgres connection "master"
[0m18:02:28.563397 [debug] [MainThread]: On master: COMMIT
[0m18:02:28.565476 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:02:28.567762 [debug] [MainThread]: On master: Close
[0m18:02:28.573915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:28.576325 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m18:02:28.580244 [info ] [MainThread]: 
[0m18:02:28.584132 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 6.59 seconds (6.59s).
[0m18:02:28.586809 [debug] [MainThread]: Command end result
[0m18:02:28.625155 [info ] [MainThread]: 
[0m18:02:28.627319 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:28.629361 [info ] [MainThread]: 
[0m18:02:28.631626 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:02:28.634846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.074143, "process_user_time": 6.335817, "process_kernel_time": 0.236484, "process_mem_max_rss": "113108", "process_out_blocks": "96", "process_in_blocks": "0"}
[0m18:02:28.637468 [debug] [MainThread]: Command `dbt run` succeeded at 18:02:28.636948 after 9.08 seconds
[0m18:02:28.639895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb485efed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb485efd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb4c400890>]}
[0m18:02:28.644295 [debug] [MainThread]: Flushing usage events
[0m18:04:11.273910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32a3f93d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32a3e8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32a3ebdd0>]}


============================== 18:04:11.284710 | fce3f9fb-437a-498c-84e3-1b3aa03b1a54 ==============================
[0m18:04:11.284710 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:04:11.286821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:04:11.289659 [info ] [MainThread]: dbt version: 1.7.16
[0m18:04:11.291150 [info ] [MainThread]: python version: 3.11.2
[0m18:04:11.292685 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:04:11.294154 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m18:04:11.438228 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:04:11.440351 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:04:11.442153 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:04:11.626864 [info ] [MainThread]: Configuration:
[0m18:04:11.628605 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:04:11.630263 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:04:11.632365 [info ] [MainThread]: Required dependencies:
[0m18:04:11.634297 [debug] [MainThread]: Executing "git --help"
[0m18:04:11.640466 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:04:11.642697 [debug] [MainThread]: STDERR: "b''"
[0m18:04:11.644420 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:04:11.646188 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:04:11.648890 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:04:11.651444 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "retail_poc", target "dev" invalid: None is not of type 'string'


[0m18:04:11.655268 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.4799122, "process_user_time": 4.615566, "process_kernel_time": 0.199808, "process_mem_max_rss": "100240", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m18:04:11.658205 [debug] [MainThread]: Command `dbt debug` failed at 18:04:11.657677 after 0.48 seconds
[0m18:04:11.661437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32a3cd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32ae11650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe32e4a0510>]}
[0m18:04:11.663897 [debug] [MainThread]: Flushing usage events
[0m18:05:35.007449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e5759b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e5749e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e572a590>]}


============================== 18:05:35.022745 | d7ef4f5c-7cbc-4529-87cf-fb64bb2e07ee ==============================
[0m18:05:35.022745 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:05:35.026541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:05:35.030100 [info ] [MainThread]: dbt version: 1.7.16
[0m18:05:35.033611 [info ] [MainThread]: python version: 3.11.2
[0m18:05:35.035422 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:05:35.037180 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m18:05:35.220241 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:05:35.222389 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:05:35.224107 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:05:35.444478 [info ] [MainThread]: Configuration:
[0m18:05:35.446479 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:05:35.449746 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:05:35.451497 [info ] [MainThread]: Required dependencies:
[0m18:05:35.453118 [debug] [MainThread]: Executing "git --help"
[0m18:05:35.457994 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:05:35.459794 [debug] [MainThread]: STDERR: "b''"
[0m18:05:35.461579 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:05:35.464899 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:05:35.466624 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:05:35.468525 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "retail_poc", target "dev" invalid: None is not of type 'string'


[0m18:05:35.472260 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.6144282, "process_user_time": 4.193465, "process_kernel_time": 0.299533, "process_mem_max_rss": "99896", "process_out_blocks": "1216", "command_success": false, "process_in_blocks": "0"}
[0m18:05:35.474240 [debug] [MainThread]: Command `dbt debug` failed at 18:05:35.473880 after 0.62 seconds
[0m18:05:35.477395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e5da5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e572ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1e96dc590>]}
[0m18:05:35.479285 [debug] [MainThread]: Flushing usage events
[0m18:07:17.750522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50f503a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff51061bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50f91eb50>]}


============================== 18:07:17.755547 | 5de9befa-6319-49f9-98b3-740c551bc37d ==============================
[0m18:07:17.755547 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:07:17.757807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:07:17.760806 [info ] [MainThread]: dbt version: 1.7.16
[0m18:07:17.762388 [info ] [MainThread]: python version: 3.11.2
[0m18:07:17.763920 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:07:17.765441 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m18:07:17.909428 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:07:17.911739 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:07:17.913791 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:07:18.089158 [info ] [MainThread]: Configuration:
[0m18:07:18.091556 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:07:18.093468 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:07:18.095101 [info ] [MainThread]: Required dependencies:
[0m18:07:18.096776 [debug] [MainThread]: Executing "git --help"
[0m18:07:18.100756 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:07:18.102508 [debug] [MainThread]: STDERR: "b''"
[0m18:07:18.104309 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:07:18.106168 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:07:18.108101 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:07:18.110008 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "retail_poc", target "dev" invalid: None is not of type 'string'


[0m18:07:18.113172 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.45946512, "process_user_time": 4.019554, "process_kernel_time": 0.230548, "process_mem_max_rss": "99780", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:07:18.115310 [debug] [MainThread]: Command `dbt debug` failed at 18:07:18.115028 after 0.46 seconds
[0m18:07:18.116793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50f508f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50f37bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff513484e90>]}
[0m18:07:18.118579 [debug] [MainThread]: Flushing usage events
[0m18:08:28.732539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f630942a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6309429090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6309429110>]}


============================== 18:08:28.742094 | b7c975e6-4bfc-4fe2-a786-371a1d7f8c63 ==============================
[0m18:08:28.742094 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:08:28.744634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:08:28.747955 [info ] [MainThread]: dbt version: 1.7.16
[0m18:08:28.749687 [info ] [MainThread]: python version: 3.11.2
[0m18:08:28.751443 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:08:28.754432 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m18:08:28.896196 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:08:28.898028 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:08:28.899523 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:08:29.049272 [info ] [MainThread]: Configuration:
[0m18:08:29.051126 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:08:29.052951 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:08:29.054796 [info ] [MainThread]: Required dependencies:
[0m18:08:29.056406 [debug] [MainThread]: Executing "git --help"
[0m18:08:29.059844 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:08:29.061406 [debug] [MainThread]: STDERR: "b''"
[0m18:08:29.062845 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:08:29.064290 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:08:29.065636 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:08:29.067001 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "retail_poc", target "dev" invalid: 'schema' is a required property


[0m18:08:29.069096 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.4536448, "process_user_time": 3.820701, "process_kernel_time": 0.229441, "process_mem_max_rss": "99924", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:08:29.070663 [debug] [MainThread]: Command `dbt debug` failed at 18:08:29.070446 after 0.46 seconds
[0m18:08:29.071926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f630923fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63093d8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f630d2435d0>]}
[0m18:08:29.073258 [debug] [MainThread]: Flushing usage events
[0m18:09:40.782247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f97096d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f9bc98d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f9bc9ad0>]}


============================== 18:09:40.788384 | 08c3ebe9-187c-4e83-b3b6-8f25d7e76d87 ==============================
[0m18:09:40.788384 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:09:40.790428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:09:40.792963 [info ] [MainThread]: dbt version: 1.7.16
[0m18:09:40.794646 [info ] [MainThread]: python version: 3.11.2
[0m18:09:40.796302 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:09:40.797767 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m18:09:40.925849 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:09:40.927877 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:09:40.929633 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:09:40.931626 [info ] [MainThread]: adapter type: postgres
[0m18:09:40.933314 [info ] [MainThread]: adapter version: 1.7.16
[0m18:09:41.072827 [info ] [MainThread]: Configuration:
[0m18:09:41.075279 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:09:41.077409 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:09:41.079040 [info ] [MainThread]: Required dependencies:
[0m18:09:41.080688 [debug] [MainThread]: Executing "git --help"
[0m18:09:41.085770 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:09:41.088202 [debug] [MainThread]: STDERR: "b''"
[0m18:09:41.092427 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:09:41.094844 [info ] [MainThread]: Connection:
[0m18:09:41.099002 [info ] [MainThread]:   host: postgres
[0m18:09:41.101081 [info ] [MainThread]:   port: 5432
[0m18:09:41.103125 [info ] [MainThread]:   user: demo
[0m18:09:41.106000 [info ] [MainThread]:   database: demo
[0m18:09:41.108639 [info ] [MainThread]:   schema: 
[0m18:09:41.112113 [info ] [MainThread]:   connect_timeout: 10
[0m18:09:41.114019 [info ] [MainThread]:   role: None
[0m18:09:41.116468 [info ] [MainThread]:   search_path: None
[0m18:09:41.118635 [info ] [MainThread]:   keepalives_idle: 0
[0m18:09:41.120729 [info ] [MainThread]:   sslmode: None
[0m18:09:41.122959 [info ] [MainThread]:   sslcert: None
[0m18:09:41.124804 [info ] [MainThread]:   sslkey: None
[0m18:09:41.126251 [info ] [MainThread]:   sslrootcert: None
[0m18:09:41.127822 [info ] [MainThread]:   application_name: dbt
[0m18:09:41.129403 [info ] [MainThread]:   retries: 1
[0m18:09:41.130924 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m18:09:41.132913 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:09:41.134928 [debug] [MainThread]: Using postgres connection "debug"
[0m18:09:41.136985 [debug] [MainThread]: On debug: select 1 as id
[0m18:09:41.138858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:41.160313 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m18:09:41.166860 [debug] [MainThread]: On debug: Close
[0m18:09:41.169540 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:09:41.172527 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:09:41.177100 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.49552602, "process_user_time": 3.731558, "process_kernel_time": 0.230096, "process_mem_max_rss": "102104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:09:41.179796 [debug] [MainThread]: Command `dbt debug` succeeded at 18:09:41.179461 after 0.50 seconds
[0m18:09:41.181525 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:09:41.183231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f9754790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f9588610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9f9aa2910>]}
[0m18:09:41.186366 [debug] [MainThread]: Flushing usage events
[0m18:09:46.214996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557be8db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557c325a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557bec2c90>]}


============================== 18:09:46.223080 | 4d458340-94f0-4268-b94e-18f7955d671e ==============================
[0m18:09:46.223080 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:09:46.226144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:09:46.594088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d458340-94f0-4268-b94e-18f7955d671e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557bdada90>]}
[0m18:09:46.711820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d458340-94f0-4268-b94e-18f7955d671e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557a5ab6d0>]}
[0m18:09:46.715374 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m18:09:46.740384 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m18:09:46.772731 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:09:46.774857 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:09:46.777121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4d458340-94f0-4268-b94e-18f7955d671e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557bec0c10>]}
[0m18:09:48.788002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d458340-94f0-4268-b94e-18f7955d671e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557a6758d0>]}
[0m18:09:48.829782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d458340-94f0-4268-b94e-18f7955d671e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557a48d550>]}
[0m18:09:48.832227 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:09:48.834273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d458340-94f0-4268-b94e-18f7955d671e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557a4aeb90>]}
[0m18:09:48.839286 [info ] [MainThread]: 
[0m18:09:48.842251 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:48.846596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m18:09:48.938656 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m18:09:48.940320 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:09:48.942265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:48.956640 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:09:48.959911 [debug] [ThreadPool]: On list_demo: Close
[0m18:09:48.966263 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m18:09:48.968110 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:09:48.969913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:48.983093 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:09:48.988292 [debug] [ThreadPool]: On list_demo: Close
[0m18:09:48.994617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo__analytics_staging)
[0m18:09:48.997759 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "_analytics_staging"
"
[0m18:09:49.010057 [debug] [ThreadPool]: Using postgres connection "create_demo__analytics_staging"
[0m18:09:49.012236 [debug] [ThreadPool]: On create_demo__analytics_staging: BEGIN
[0m18:09:49.013994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:49.026590 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:09:49.028506 [debug] [ThreadPool]: Using postgres connection "create_demo__analytics_staging"
[0m18:09:49.030036 [debug] [ThreadPool]: On create_demo__analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo__analytics_staging"} */
create schema if not exists _analytics_staging
[0m18:09:49.032365 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:09:49.034788 [debug] [ThreadPool]: On create_demo__analytics_staging: COMMIT
[0m18:09:49.036392 [debug] [ThreadPool]: Using postgres connection "create_demo__analytics_staging"
[0m18:09:49.038065 [debug] [ThreadPool]: On create_demo__analytics_staging: COMMIT
[0m18:09:49.042204 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:09:49.043628 [debug] [ThreadPool]: On create_demo__analytics_staging: Close
[0m18:09:49.047264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo__analytics_staging, now create_demo__analytics_analytics)
[0m18:09:49.049735 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "_analytics_analytics"
"
[0m18:09:49.054753 [debug] [ThreadPool]: Using postgres connection "create_demo__analytics_analytics"
[0m18:09:49.056451 [debug] [ThreadPool]: On create_demo__analytics_analytics: BEGIN
[0m18:09:49.058206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:49.070058 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:09:49.071809 [debug] [ThreadPool]: Using postgres connection "create_demo__analytics_analytics"
[0m18:09:49.073384 [debug] [ThreadPool]: On create_demo__analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo__analytics_analytics"} */
create schema if not exists _analytics_analytics
[0m18:09:49.075254 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:09:49.077617 [debug] [ThreadPool]: On create_demo__analytics_analytics: COMMIT
[0m18:09:49.078989 [debug] [ThreadPool]: Using postgres connection "create_demo__analytics_analytics"
[0m18:09:49.080392 [debug] [ThreadPool]: On create_demo__analytics_analytics: COMMIT
[0m18:09:49.083602 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:09:49.084936 [debug] [ThreadPool]: On create_demo__analytics_analytics: Close
[0m18:09:49.089155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo__analytics_analytics, now list_demo__analytics_staging)
[0m18:09:49.100104 [debug] [ThreadPool]: Using postgres connection "list_demo__analytics_staging"
[0m18:09:49.102026 [debug] [ThreadPool]: On list_demo__analytics_staging: BEGIN
[0m18:09:49.103859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:49.119409 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:09:49.121691 [debug] [ThreadPool]: Using postgres connection "list_demo__analytics_staging"
[0m18:09:49.124286 [debug] [ThreadPool]: On list_demo__analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo__analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics_staging'
  
[0m18:09:49.131454 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:09:49.134802 [debug] [ThreadPool]: On list_demo__analytics_staging: ROLLBACK
[0m18:09:49.136881 [debug] [ThreadPool]: On list_demo__analytics_staging: Close
[0m18:09:49.140113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo__analytics_staging, now list_demo__analytics_analytics)
[0m18:09:49.147145 [debug] [ThreadPool]: Using postgres connection "list_demo__analytics_analytics"
[0m18:09:49.148919 [debug] [ThreadPool]: On list_demo__analytics_analytics: BEGIN
[0m18:09:49.150408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:49.164434 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:09:49.166776 [debug] [ThreadPool]: Using postgres connection "list_demo__analytics_analytics"
[0m18:09:49.168944 [debug] [ThreadPool]: On list_demo__analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo__analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike '_analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike '_analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike '_analytics_analytics'
  
[0m18:09:49.175859 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:09:49.179628 [debug] [ThreadPool]: On list_demo__analytics_analytics: ROLLBACK
[0m18:09:49.181709 [debug] [ThreadPool]: On list_demo__analytics_analytics: Close
[0m18:09:49.196463 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:49.203728 [debug] [MainThread]: On master: BEGIN
[0m18:09:49.207306 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:49.237364 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:49.239298 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:49.241993 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:49.252603 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:09:49.257622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d458340-94f0-4268-b94e-18f7955d671e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557a4aca90>]}
[0m18:09:49.260042 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:49.262263 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:49.263870 [debug] [MainThread]: On master: BEGIN
[0m18:09:49.266054 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:49.267866 [debug] [MainThread]: On master: COMMIT
[0m18:09:49.270035 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:49.271538 [debug] [MainThread]: On master: COMMIT
[0m18:09:49.273362 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:09:49.275203 [debug] [MainThread]: On master: Close
[0m18:09:49.278705 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:49.281235 [info ] [MainThread]: 
[0m18:09:49.303837 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m18:09:49.306656 [info ] [Thread-1 (]: 1 of 2 START sql table model _analytics_staging.stg_transactions ............... [RUN]
[0m18:09:49.310339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo__analytics_analytics, now model.retail_poc.stg_transactions)
[0m18:09:49.313585 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m18:09:49.335412 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m18:09:49.352376 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 18:09:49.315353 => 18:09:49.351460
[0m18:09:49.355174 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m18:09:49.452592 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m18:09:49.469012 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:09:49.472507 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m18:09:49.474663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:49.491458 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:49.493706 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:09:49.496085 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo"._analytics_staging."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m18:09:51.896220 [debug] [Thread-1 (]: SQL status: SELECT 1500000 in 2.0 seconds
[0m18:09:51.907932 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:09:51.909886 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"._analytics_staging."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m18:09:51.912483 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:51.944252 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m18:09:51.946307 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:09:51.947990 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m18:09:51.960945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:51.976395 [debug] [Thread-1 (]: Applying DROP to: "demo"._analytics_staging."stg_transactions__dbt_backup"
[0m18:09:51.989545 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:09:51.991662 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo"._analytics_staging."stg_transactions__dbt_backup" cascade
[0m18:09:51.994121 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:09:51.998089 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 18:09:49.356675 => 18:09:51.997719
[0m18:09:51.999956 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m18:09:52.003154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d458340-94f0-4268-b94e-18f7955d671e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557d5e6710>]}
[0m18:09:52.006128 [info ] [Thread-1 (]: 1 of 2 OK created sql table model _analytics_staging.stg_transactions .......... [[32mSELECT 1500000[0m in 2.69s]
[0m18:09:52.008674 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m18:09:52.011750 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m18:09:52.013725 [info ] [Thread-1 (]: 2 of 2 START sql table model _analytics_analytics.fact_orders .................. [RUN]
[0m18:09:52.016409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m18:09:52.018424 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m18:09:52.024399 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m18:09:52.035599 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 18:09:52.019733 => 18:09:52.035083
[0m18:09:52.037335 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m18:09:52.046754 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m18:09:52.058237 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:09:52.060173 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m18:09:52.062067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:52.074372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:09:52.076677 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:09:52.078572 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo"._analytics_analytics."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo"._analytics_staging."stg_transactions"
WHERE status = 'completed'   -- optional filter for valid orders
GROUP BY user_id
  );
  
[0m18:09:56.074404 [debug] [Thread-1 (]: SQL status: SELECT 80000 in 4.0 seconds
[0m18:09:56.081134 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:09:56.083048 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"._analytics_analytics."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:09:56.085323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:09:56.089706 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m18:09:56.091499 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:09:56.093275 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m18:09:56.154788 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:09:56.161207 [debug] [Thread-1 (]: Applying DROP to: "demo"._analytics_analytics."fact_orders__dbt_backup"
[0m18:09:56.164227 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:09:56.166209 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo"._analytics_analytics."fact_orders__dbt_backup" cascade
[0m18:09:56.168416 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:09:56.172375 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 18:09:52.038639 => 18:09:56.172009
[0m18:09:56.174191 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m18:09:56.176773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d458340-94f0-4268-b94e-18f7955d671e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557a4d5a50>]}
[0m18:09:56.179075 [info ] [Thread-1 (]: 2 of 2 OK created sql table model _analytics_analytics.fact_orders ............. [[32mSELECT 80000[0m in 4.16s]
[0m18:09:56.181186 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m18:09:56.184846 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:56.186693 [debug] [MainThread]: On master: BEGIN
[0m18:09:56.188433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:56.200958 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:09:56.202875 [debug] [MainThread]: On master: COMMIT
[0m18:09:56.204364 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:56.205828 [debug] [MainThread]: On master: COMMIT
[0m18:09:56.207416 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:09:56.208818 [debug] [MainThread]: On master: Close
[0m18:09:56.210795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:56.212188 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m18:09:56.213770 [info ] [MainThread]: 
[0m18:09:56.215252 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.37 seconds (7.37s).
[0m18:09:56.217756 [debug] [MainThread]: Command end result
[0m18:09:56.246409 [info ] [MainThread]: 
[0m18:09:56.248116 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:56.249681 [info ] [MainThread]: 
[0m18:09:56.251256 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:09:56.253514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.187257, "process_user_time": 6.907518, "process_kernel_time": 0.24131, "process_mem_max_rss": "112692", "process_out_blocks": "96", "process_in_blocks": "0"}
[0m18:09:56.255697 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:56.255311 after 10.19 seconds
[0m18:09:56.257260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557c325290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557c325650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f557fcd8890>]}
[0m18:09:56.258960 [debug] [MainThread]: Flushing usage events
[0m18:11:21.038459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcbcf6fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcbcf6c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcbcf6d790>]}


============================== 18:11:21.050057 | 080f8895-1b46-4d1e-aed3-30f7e3e5117d ==============================
[0m18:11:21.050057 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:11:21.052922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:11:21.055834 [info ] [MainThread]: dbt version: 1.7.16
[0m18:11:21.057899 [info ] [MainThread]: python version: 3.11.2
[0m18:11:21.059901 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:11:21.061501 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m18:11:21.196861 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:11:21.198820 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:11:21.200725 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:11:21.202676 [info ] [MainThread]: adapter type: postgres
[0m18:11:21.204236 [info ] [MainThread]: adapter version: 1.7.16
[0m18:11:21.345218 [info ] [MainThread]: Configuration:
[0m18:11:21.347326 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:11:21.349186 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:11:21.351870 [info ] [MainThread]: Required dependencies:
[0m18:11:21.353876 [debug] [MainThread]: Executing "git --help"
[0m18:11:21.358042 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:11:21.359727 [debug] [MainThread]: STDERR: "b''"
[0m18:11:21.361140 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:11:21.362614 [info ] [MainThread]: Connection:
[0m18:11:21.364460 [info ] [MainThread]:   host: postgres
[0m18:11:21.365970 [info ] [MainThread]:   port: 5432
[0m18:11:21.367334 [info ] [MainThread]:   user: demo
[0m18:11:21.368984 [info ] [MainThread]:   database: demo
[0m18:11:21.370503 [info ] [MainThread]:   schema: analytics
[0m18:11:21.371951 [info ] [MainThread]:   connect_timeout: 10
[0m18:11:21.373377 [info ] [MainThread]:   role: None
[0m18:11:21.374760 [info ] [MainThread]:   search_path: None
[0m18:11:21.376167 [info ] [MainThread]:   keepalives_idle: 0
[0m18:11:21.377651 [info ] [MainThread]:   sslmode: None
[0m18:11:21.379041 [info ] [MainThread]:   sslcert: None
[0m18:11:21.380412 [info ] [MainThread]:   sslkey: None
[0m18:11:21.381836 [info ] [MainThread]:   sslrootcert: None
[0m18:11:21.383241 [info ] [MainThread]:   application_name: dbt
[0m18:11:21.384889 [info ] [MainThread]:   retries: 1
[0m18:11:21.386898 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m18:11:21.389101 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:11:21.390740 [debug] [MainThread]: Using postgres connection "debug"
[0m18:11:21.392115 [debug] [MainThread]: On debug: select 1 as id
[0m18:11:21.393387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:21.408727 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m18:11:21.411914 [debug] [MainThread]: On debug: Close
[0m18:11:21.413916 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:11:21.415741 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:11:21.418566 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.48493403, "process_user_time": 4.459004, "process_kernel_time": 0.340687, "process_mem_max_rss": "102496", "process_out_blocks": "1216", "process_in_blocks": "0"}
[0m18:11:21.420770 [debug] [MainThread]: Command `dbt debug` succeeded at 18:11:21.420481 after 0.49 seconds
[0m18:11:21.422312 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:11:21.424051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcbcf6d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcbb8cee90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcc0f5c850>]}
[0m18:11:21.425767 [debug] [MainThread]: Flushing usage events
[0m18:11:26.773276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b0919010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b0919610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b0919490>]}


============================== 18:11:26.778320 | da287384-fd0f-4817-a7eb-f855c580cc9c ==============================
[0m18:11:26.778320 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:11:26.780176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m18:11:27.049386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da287384-fd0f-4817-a7eb-f855c580cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b08c3fd0>]}
[0m18:11:27.192044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da287384-fd0f-4817-a7eb-f855c580cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b1580750>]}
[0m18:11:27.194784 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m18:11:27.222262 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m18:11:27.250452 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:11:27.252307 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:11:27.253892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'da287384-fd0f-4817-a7eb-f855c580cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b0750a10>]}
[0m18:11:28.979849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da287384-fd0f-4817-a7eb-f855c580cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33aef3a190>]}
[0m18:11:29.033283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da287384-fd0f-4817-a7eb-f855c580cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33aef739d0>]}
[0m18:11:29.035255 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:11:29.036833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da287384-fd0f-4817-a7eb-f855c580cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b36dd6d0>]}
[0m18:11:29.041948 [info ] [MainThread]: 
[0m18:11:29.044743 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:11:29.047731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m18:11:29.123359 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m18:11:29.125370 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:11:29.127147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:29.142227 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:11:29.145692 [debug] [ThreadPool]: On list_demo: Close
[0m18:11:29.152003 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m18:11:29.153692 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:11:29.155299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:29.168286 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:11:29.171511 [debug] [ThreadPool]: On list_demo: Close
[0m18:11:29.175306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_analytics_analytics_analytics)
[0m18:11:29.177712 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_analytics_analytics"
"
[0m18:11:29.188403 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m18:11:29.190157 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: BEGIN
[0m18:11:29.191796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:29.205488 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:11:29.207027 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m18:11:29.208588 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_analytics_analytics"} */
create schema if not exists analytics_analytics_analytics
[0m18:11:29.210366 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:11:29.212582 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: COMMIT
[0m18:11:29.213928 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m18:11:29.215404 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: COMMIT
[0m18:11:29.467070 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:11:29.468869 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: Close
[0m18:11:29.472499 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_analytics_analytics, now create_demo_analytics_analytics_staging)
[0m18:11:29.474895 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_analytics_staging"
"
[0m18:11:29.480707 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m18:11:29.482366 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: BEGIN
[0m18:11:29.483928 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:29.499157 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:11:29.500861 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m18:11:29.502316 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_analytics_staging"} */
create schema if not exists analytics_analytics_staging
[0m18:11:29.504258 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:11:29.506600 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: COMMIT
[0m18:11:29.508088 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m18:11:29.509238 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: COMMIT
[0m18:11:29.735008 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:11:29.736823 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: Close
[0m18:11:29.741538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_analytics_staging, now list_demo_analytics_analytics_analytics)
[0m18:11:29.754423 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m18:11:29.756491 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: BEGIN
[0m18:11:29.758257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:29.771127 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:11:29.773221 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m18:11:29.775261 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_analytics'
  
[0m18:11:29.781352 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:11:29.785560 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: ROLLBACK
[0m18:11:29.787742 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: Close
[0m18:11:29.790822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_analytics, now list_demo_analytics_analytics_staging)
[0m18:11:29.795994 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m18:11:29.798158 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: BEGIN
[0m18:11:29.800064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:29.813067 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:11:29.814921 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m18:11:29.816567 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m18:11:29.822455 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:11:29.825733 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: ROLLBACK
[0m18:11:29.827698 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: Close
[0m18:11:29.837215 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:29.838900 [debug] [MainThread]: On master: BEGIN
[0m18:11:29.840305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:29.853908 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:29.855892 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:29.857566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:11:29.864457 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:11:29.867879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da287384-fd0f-4817-a7eb-f855c580cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33aefbfa90>]}
[0m18:11:29.869913 [debug] [MainThread]: On master: ROLLBACK
[0m18:11:29.871928 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:29.873619 [debug] [MainThread]: On master: BEGIN
[0m18:11:29.875846 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:29.877864 [debug] [MainThread]: On master: COMMIT
[0m18:11:29.879710 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:29.881615 [debug] [MainThread]: On master: COMMIT
[0m18:11:29.884073 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:11:29.886031 [debug] [MainThread]: On master: Close
[0m18:11:29.888665 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:29.890798 [info ] [MainThread]: 
[0m18:11:29.909958 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m18:11:29.912438 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_analytics_staging.stg_transactions ...... [RUN]
[0m18:11:29.914998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_staging, now model.retail_poc.stg_transactions)
[0m18:11:29.916946 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m18:11:29.930930 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m18:11:29.944729 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 18:11:29.918487 => 18:11:29.944196
[0m18:11:29.946387 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m18:11:30.048317 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m18:11:30.061597 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:11:30.063423 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m18:11:30.065181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:30.077944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:11:30.080696 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:11:30.083362 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo".analytics_analytics_staging."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m18:11:33.025288 [debug] [Thread-1 (]: SQL status: SELECT 2000000 in 3.0 seconds
[0m18:11:33.036829 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:11:33.038904 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo".analytics_analytics_staging."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m18:11:33.041582 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:33.074227 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m18:11:33.076311 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:11:33.078066 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m18:11:33.091917 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:11:33.104259 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics_staging."stg_transactions__dbt_backup"
[0m18:11:33.115014 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:11:33.116855 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo".analytics_analytics_staging."stg_transactions__dbt_backup" cascade
[0m18:11:33.119294 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:11:33.123077 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 18:11:29.947736 => 18:11:33.122675
[0m18:11:33.124770 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m18:11:33.127827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da287384-fd0f-4817-a7eb-f855c580cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b091be50>]}
[0m18:11:33.130212 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_analytics_staging.stg_transactions . [[32mSELECT 2000000[0m in 3.21s]
[0m18:11:33.132538 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m18:11:33.135115 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m18:11:33.136713 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics_analytics.fact_orders ......... [RUN]
[0m18:11:33.138947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m18:11:33.140463 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m18:11:33.148229 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m18:11:33.160106 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 18:11:33.141687 => 18:11:33.159581
[0m18:11:33.161677 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m18:11:33.171161 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m18:11:33.183259 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:11:33.184988 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m18:11:33.186547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:11:33.199424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:11:33.201454 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:11:33.203093 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo".analytics_analytics_analytics."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo".analytics_analytics_staging."stg_transactions"
WHERE status = 'completed'   -- optional filter for valid orders
GROUP BY user_id
  );
  
[0m18:11:38.592435 [debug] [Thread-1 (]: SQL status: SELECT 80000 in 5.0 seconds
[0m18:11:38.599957 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:11:38.602189 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo".analytics_analytics_analytics."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:11:38.604858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:11:38.611102 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m18:11:38.613569 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:11:38.615546 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m18:11:38.620074 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:11:38.627039 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics_analytics."fact_orders__dbt_backup"
[0m18:11:38.630310 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:11:38.632473 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo".analytics_analytics_analytics."fact_orders__dbt_backup" cascade
[0m18:11:38.635058 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:11:38.640531 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 18:11:33.162862 => 18:11:38.639870
[0m18:11:38.642748 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m18:11:38.645416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da287384-fd0f-4817-a7eb-f855c580cc9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33af0df650>]}
[0m18:11:38.647656 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics_analytics.fact_orders .... [[32mSELECT 80000[0m in 5.51s]
[0m18:11:38.649898 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m18:11:38.653851 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:38.655487 [debug] [MainThread]: On master: BEGIN
[0m18:11:38.657037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:38.672545 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:11:38.674333 [debug] [MainThread]: On master: COMMIT
[0m18:11:38.675983 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:38.677448 [debug] [MainThread]: On master: COMMIT
[0m18:11:38.679196 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:11:38.680932 [debug] [MainThread]: On master: Close
[0m18:11:38.683226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:38.684840 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m18:11:38.687052 [info ] [MainThread]: 
[0m18:11:38.689175 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.64 seconds (9.64s).
[0m18:11:38.691664 [debug] [MainThread]: Command end result
[0m18:11:38.721491 [info ] [MainThread]: 
[0m18:11:38.723373 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:38.725124 [info ] [MainThread]: 
[0m18:11:38.726783 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:11:38.729616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.0588045, "process_user_time": 6.531709, "process_kernel_time": 0.190926, "process_mem_max_rss": "113108", "process_out_blocks": "96", "process_in_blocks": "0"}
[0m18:11:38.731884 [debug] [MainThread]: Command `dbt run` succeeded at 18:11:38.731575 after 12.06 seconds
[0m18:11:38.733607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b0d81e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b0901450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33b15807d0>]}
[0m18:11:38.735290 [debug] [MainThread]: Flushing usage events
[0m18:13:06.573088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe257eef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe2560d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe2560fa50>]}


============================== 18:13:06.587183 | 965613c0-72c6-40c8-87c4-841362c64eae ==============================
[0m18:13:06.587183 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:13:06.590027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:13:06.592926 [info ] [MainThread]: dbt version: 1.7.16
[0m18:13:06.595015 [info ] [MainThread]: python version: 3.11.2
[0m18:13:06.597439 [info ] [MainThread]: python path: /usr/local/bin/python
[0m18:13:06.599394 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m18:13:06.755477 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m18:13:06.757220 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m18:13:06.758779 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m18:13:06.760652 [info ] [MainThread]: adapter type: postgres
[0m18:13:06.762477 [info ] [MainThread]: adapter version: 1.7.16
[0m18:13:06.930724 [info ] [MainThread]: Configuration:
[0m18:13:06.932821 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:13:06.934700 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:13:06.936430 [info ] [MainThread]: Required dependencies:
[0m18:13:06.938079 [debug] [MainThread]: Executing "git --help"
[0m18:13:06.941568 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:13:06.943247 [debug] [MainThread]: STDERR: "b''"
[0m18:13:06.944584 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:13:06.946002 [info ] [MainThread]: Connection:
[0m18:13:06.947417 [info ] [MainThread]:   host: postgres
[0m18:13:06.948875 [info ] [MainThread]:   port: 5432
[0m18:13:06.950470 [info ] [MainThread]:   user: demo
[0m18:13:06.951948 [info ] [MainThread]:   database: demo
[0m18:13:06.953481 [info ] [MainThread]:   schema: analytics
[0m18:13:06.955225 [info ] [MainThread]:   connect_timeout: 10
[0m18:13:06.956728 [info ] [MainThread]:   role: None
[0m18:13:06.958238 [info ] [MainThread]:   search_path: None
[0m18:13:06.959637 [info ] [MainThread]:   keepalives_idle: 0
[0m18:13:06.961006 [info ] [MainThread]:   sslmode: None
[0m18:13:06.962522 [info ] [MainThread]:   sslcert: None
[0m18:13:06.964013 [info ] [MainThread]:   sslkey: None
[0m18:13:06.965467 [info ] [MainThread]:   sslrootcert: None
[0m18:13:06.966881 [info ] [MainThread]:   application_name: dbt
[0m18:13:06.968280 [info ] [MainThread]:   retries: 1
[0m18:13:06.970086 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m18:13:06.972042 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:13:06.973475 [debug] [MainThread]: Using postgres connection "debug"
[0m18:13:06.974811 [debug] [MainThread]: On debug: select 1 as id
[0m18:13:06.976277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:06.991186 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m18:13:06.994359 [debug] [MainThread]: On debug: Close
[0m18:13:06.996364 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:13:06.998165 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:13:07.000879 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.52617776, "process_user_time": 4.553593, "process_kernel_time": 0.280221, "process_mem_max_rss": "102716", "process_out_blocks": "1216", "process_in_blocks": "0"}
[0m18:13:07.003001 [debug] [MainThread]: Command `dbt debug` succeeded at 18:13:07.002717 after 0.53 seconds
[0m18:13:07.004914 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:13:07.006588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe25c0b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe23f5d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe296007d0>]}
[0m18:13:07.008174 [debug] [MainThread]: Flushing usage events
[0m18:13:12.233766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b122c9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b122fec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b122ff250>]}


============================== 18:13:12.238794 | b0071261-773c-450f-9f9a-15c052f11458 ==============================
[0m18:13:12.238794 [info ] [MainThread]: Running with dbt=1.7.16
[0m18:13:12.241011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:13:12.524914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0071261-773c-450f-9f9a-15c052f11458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1360a110>]}
[0m18:13:12.632789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0071261-773c-450f-9f9a-15c052f11458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b10a274d0>]}
[0m18:13:12.635147 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m18:13:12.660820 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m18:13:12.803021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:12.804796 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:12.822805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0071261-773c-450f-9f9a-15c052f11458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b128cb090>]}
[0m18:13:12.865800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0071261-773c-450f-9f9a-15c052f11458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1090cb10>]}
[0m18:13:12.869555 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m18:13:12.871639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0071261-773c-450f-9f9a-15c052f11458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b108f8210>]}
[0m18:13:12.877268 [info ] [MainThread]: 
[0m18:13:12.880340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:13:12.885205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m18:13:12.908951 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m18:13:12.911030 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:13:12.912887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:12.929856 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:13:12.933730 [debug] [ThreadPool]: On list_demo: Close
[0m18:13:12.940123 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m18:13:12.941955 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:13:12.943788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:12.956692 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:13:12.960456 [debug] [ThreadPool]: On list_demo: Close
[0m18:13:12.964061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_analytics_analytics_analytics)
[0m18:13:12.966682 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_analytics_analytics"
"
[0m18:13:12.977103 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m18:13:12.979087 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: BEGIN
[0m18:13:12.980953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:12.993512 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:13:12.995380 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m18:13:12.996972 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_analytics_analytics"} */
create schema if not exists analytics_analytics_analytics
[0m18:13:12.999269 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:13:13.001923 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: COMMIT
[0m18:13:13.003509 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m18:13:13.005030 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: COMMIT
[0m18:13:13.008660 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:13:13.010270 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: Close
[0m18:13:13.014189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_analytics_analytics, now create_demo_analytics_analytics_staging)
[0m18:13:13.016656 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_analytics_staging"
"
[0m18:13:13.022384 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m18:13:13.024141 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: BEGIN
[0m18:13:13.025733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:13.038153 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:13:13.040033 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m18:13:13.041557 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_analytics_staging"} */
create schema if not exists analytics_analytics_staging
[0m18:13:13.043969 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m18:13:13.046587 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: COMMIT
[0m18:13:13.048253 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m18:13:13.049811 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: COMMIT
[0m18:13:13.053287 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m18:13:13.054837 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: Close
[0m18:13:13.059798 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_analytics_staging, now list_demo_analytics_analytics_analytics)
[0m18:13:13.071276 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m18:13:13.073159 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: BEGIN
[0m18:13:13.074750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:13.087048 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:13:13.088980 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m18:13:13.090702 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_analytics'
  
[0m18:13:13.096559 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:13:13.099727 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: ROLLBACK
[0m18:13:13.101866 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: Close
[0m18:13:13.104960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_analytics, now list_demo_analytics_analytics_staging)
[0m18:13:13.110066 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m18:13:13.111837 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: BEGIN
[0m18:13:13.113535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:13.126692 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:13:13.128652 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m18:13:13.130263 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m18:13:13.135375 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m18:13:13.138502 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: ROLLBACK
[0m18:13:13.140268 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: Close
[0m18:13:13.148896 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:13.150606 [debug] [MainThread]: On master: BEGIN
[0m18:13:13.152308 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:13:13.164422 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:13:13.166320 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:13.168104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:13:13.174102 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m18:13:13.177566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0071261-773c-450f-9f9a-15c052f11458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1095ce10>]}
[0m18:13:13.179468 [debug] [MainThread]: On master: ROLLBACK
[0m18:13:13.181444 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:13.183119 [debug] [MainThread]: On master: BEGIN
[0m18:13:13.185242 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:13:13.186895 [debug] [MainThread]: On master: COMMIT
[0m18:13:13.188573 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:13.190344 [debug] [MainThread]: On master: COMMIT
[0m18:13:13.192241 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:13:13.193703 [debug] [MainThread]: On master: Close
[0m18:13:13.196009 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:13.197684 [info ] [MainThread]: 
[0m18:13:13.210414 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m18:13:13.212571 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_analytics_staging.stg_transactions ...... [RUN]
[0m18:13:13.215061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_staging, now model.retail_poc.stg_transactions)
[0m18:13:13.216758 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m18:13:13.230543 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m18:13:13.244762 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 18:13:13.218148 => 18:13:13.244274
[0m18:13:13.246472 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m18:13:13.329570 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m18:13:13.343232 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:13:13.344909 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m18:13:13.346413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:13.359570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:13:13.361414 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:13:13.362993 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo".analytics_analytics_staging."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m18:13:13.370907 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m18:13:13.382787 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:13:13.384665 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo".analytics_analytics_staging."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m18:13:13.386888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:13.426932 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m18:13:13.428921 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:13:13.430515 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m18:13:13.434529 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:13:13.446774 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics_staging."stg_transactions__dbt_backup"
[0m18:13:13.457892 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m18:13:13.459798 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo".analytics_analytics_staging."stg_transactions__dbt_backup" cascade
[0m18:13:13.461885 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:13:13.465650 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 18:13:13.248077 => 18:13:13.465240
[0m18:13:13.467324 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m18:13:13.469723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0071261-773c-450f-9f9a-15c052f11458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1088d710>]}
[0m18:13:13.472967 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_analytics_staging.stg_transactions . [[32mSELECT 0[0m in 0.26s]
[0m18:13:13.475036 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m18:13:13.477795 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m18:13:13.479603 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics_analytics.fact_orders ......... [RUN]
[0m18:13:13.481774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m18:13:13.483253 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m18:13:13.489479 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m18:13:13.500413 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 18:13:13.484521 => 18:13:13.499906
[0m18:13:13.501932 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m18:13:13.510698 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m18:13:13.521881 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:13:13.523596 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m18:13:13.525100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:13.536972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:13:13.538937 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:13:13.540470 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo".analytics_analytics_analytics."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo".analytics_analytics_staging."stg_transactions"
WHERE status = 'completed'   -- optional filter for valid orders
GROUP BY user_id
  );
  
[0m18:13:13.548893 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m18:13:13.555397 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:13:13.557030 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo".analytics_analytics_analytics."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:13:13.559054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:13:13.563702 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m18:13:13.566244 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:13:13.568037 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m18:13:13.571517 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:13:13.577230 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics_analytics."fact_orders__dbt_backup"
[0m18:13:13.579666 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m18:13:13.581340 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo".analytics_analytics_analytics."fact_orders__dbt_backup" cascade
[0m18:13:13.583211 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:13:13.586593 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 18:13:13.503230 => 18:13:13.586242
[0m18:13:13.588064 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m18:13:13.590577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0071261-773c-450f-9f9a-15c052f11458', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1089ac50>]}
[0m18:13:13.592944 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics_analytics.fact_orders .... [[32mSELECT 0[0m in 0.11s]
[0m18:13:13.595570 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m18:13:13.599939 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:13.601631 [debug] [MainThread]: On master: BEGIN
[0m18:13:13.603237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:13:13.615477 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:13:13.617228 [debug] [MainThread]: On master: COMMIT
[0m18:13:13.618568 [debug] [MainThread]: Using postgres connection "master"
[0m18:13:13.620083 [debug] [MainThread]: On master: COMMIT
[0m18:13:13.621883 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:13:13.623284 [debug] [MainThread]: On master: Close
[0m18:13:13.625259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:13.626567 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m18:13:13.627999 [info ] [MainThread]: 
[0m18:13:13.629476 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m18:13:13.631701 [debug] [MainThread]: Command end result
[0m18:13:13.660761 [info ] [MainThread]: 
[0m18:13:13.662443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:13.664220 [info ] [MainThread]: 
[0m18:13:13.665802 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:13:13.667994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5376763, "process_user_time": 4.866922, "process_kernel_time": 0.258772, "process_mem_max_rss": "109820", "process_out_blocks": "96", "process_in_blocks": "0"}
[0m18:13:13.669839 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:13.669586 after 1.54 seconds
[0m18:13:13.671659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b122fd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b122fe610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b16114890>]}
[0m18:13:13.673327 [debug] [MainThread]: Flushing usage events
[0m20:43:34.087004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ce232250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ce8c1cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ce230cd0>]}


============================== 20:43:34.108484 | 2f16982c-5029-4a2c-8deb-6d01929ceeb0 ==============================
[0m20:43:34.108484 [info ] [MainThread]: Running with dbt=1.7.16
[0m20:43:34.110608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:43:34.113812 [info ] [MainThread]: dbt version: 1.7.16
[0m20:43:34.115371 [info ] [MainThread]: python version: 3.11.2
[0m20:43:34.116877 [info ] [MainThread]: python path: /usr/local/bin/python
[0m20:43:34.118384 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m20:43:34.269403 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m20:43:34.271453 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m20:43:34.273224 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m20:43:34.275211 [info ] [MainThread]: adapter type: postgres
[0m20:43:34.276692 [info ] [MainThread]: adapter version: 1.7.16
[0m20:43:34.463429 [info ] [MainThread]: Configuration:
[0m20:43:34.465949 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:43:34.468528 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:43:34.470827 [info ] [MainThread]: Required dependencies:
[0m20:43:34.472850 [debug] [MainThread]: Executing "git --help"
[0m20:43:34.483065 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:43:34.485799 [debug] [MainThread]: STDERR: "b''"
[0m20:43:34.488260 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:43:34.490225 [info ] [MainThread]: Connection:
[0m20:43:34.491993 [info ] [MainThread]:   host: postgres
[0m20:43:34.493741 [info ] [MainThread]:   port: 5432
[0m20:43:34.495712 [info ] [MainThread]:   user: demo
[0m20:43:34.497563 [info ] [MainThread]:   database: demo
[0m20:43:34.499564 [info ] [MainThread]:   schema: analytics
[0m20:43:34.501600 [info ] [MainThread]:   connect_timeout: 10
[0m20:43:34.503375 [info ] [MainThread]:   role: None
[0m20:43:34.505052 [info ] [MainThread]:   search_path: None
[0m20:43:34.506910 [info ] [MainThread]:   keepalives_idle: 0
[0m20:43:34.508827 [info ] [MainThread]:   sslmode: None
[0m20:43:34.511012 [info ] [MainThread]:   sslcert: None
[0m20:43:34.513089 [info ] [MainThread]:   sslkey: None
[0m20:43:34.515318 [info ] [MainThread]:   sslrootcert: None
[0m20:43:34.517508 [info ] [MainThread]:   application_name: dbt
[0m20:43:34.519758 [info ] [MainThread]:   retries: 1
[0m20:43:34.522220 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m20:43:34.558475 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:43:34.563817 [debug] [MainThread]: Using postgres connection "debug"
[0m20:43:34.573279 [debug] [MainThread]: On debug: select 1 as id
[0m20:43:34.575361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:43:34.651186 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:43:34.671637 [debug] [MainThread]: On debug: Close
[0m20:43:34.676362 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:43:34.678568 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:43:34.681514 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.729357, "process_user_time": 5.631182, "process_kernel_time": 1.307238, "process_mem_max_rss": "102180", "process_out_blocks": "1216", "process_in_blocks": "0"}
[0m20:43:34.683489 [debug] [MainThread]: Command `dbt debug` succeeded at 20:43:34.683241 after 0.73 seconds
[0m20:43:34.684914 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:43:34.686740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ce268510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ccb22d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43ce245bd0>]}
[0m20:43:34.689026 [debug] [MainThread]: Flushing usage events
[0m20:43:39.757275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa07e42890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0932ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa07e89090>]}


============================== 20:43:39.766616 | 154a9fc7-a0b8-4ff8-8d89-1098d85dfb23 ==============================
[0m20:43:39.766616 [info ] [MainThread]: Running with dbt=1.7.16
[0m20:43:39.769357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:43:40.155437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '154a9fc7-a0b8-4ff8-8d89-1098d85dfb23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0659a510>]}
[0m20:43:40.286978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '154a9fc7-a0b8-4ff8-8d89-1098d85dfb23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa06573750>]}
[0m20:43:40.290129 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m20:43:40.325006 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m20:43:40.556415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:43:40.558470 [debug] [MainThread]: Partial parsing: added file: retail_poc://macros/generate_schema_name.sql
[0m20:43:40.595053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '154a9fc7-a0b8-4ff8-8d89-1098d85dfb23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa06497e50>]}
[0m20:43:40.655215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '154a9fc7-a0b8-4ff8-8d89-1098d85dfb23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa064efb10>]}
[0m20:43:40.657012 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:43:40.659127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154a9fc7-a0b8-4ff8-8d89-1098d85dfb23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa06503a90>]}
[0m20:43:40.663403 [info ] [MainThread]: 
[0m20:43:40.666491 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:43:40.669900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m20:43:40.694560 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m20:43:40.696816 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m20:43:40.698500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:43:40.716439 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:43:40.720119 [debug] [ThreadPool]: On list_demo: Close
[0m20:43:40.726956 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m20:43:40.729123 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m20:43:40.731055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:40.750547 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m20:43:40.754666 [debug] [ThreadPool]: On list_demo: Close
[0m20:43:40.760460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_analytics_analytics_analytics)
[0m20:43:40.763831 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_analytics_analytics"
"
[0m20:43:40.775196 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m20:43:40.777252 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: BEGIN
[0m20:43:40.779071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:40.793137 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:43:40.794910 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m20:43:40.796438 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_analytics_analytics"} */
create schema if not exists analytics_analytics_analytics
[0m20:43:40.798986 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m20:43:40.801686 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: COMMIT
[0m20:43:40.803201 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_analytics"
[0m20:43:40.804837 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: COMMIT
[0m20:43:40.808404 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m20:43:40.810162 [debug] [ThreadPool]: On create_demo_analytics_analytics_analytics: Close
[0m20:43:40.813626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_analytics_analytics, now create_demo_analytics_analytics_staging)
[0m20:43:40.815914 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_analytics_staging"
"
[0m20:43:40.820893 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m20:43:40.822482 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: BEGIN
[0m20:43:40.823879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:40.835916 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:43:40.837978 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m20:43:40.839764 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_analytics_staging"} */
create schema if not exists analytics_analytics_staging
[0m20:43:40.842626 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m20:43:40.845158 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: COMMIT
[0m20:43:40.846734 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics_staging"
[0m20:43:40.848266 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: COMMIT
[0m20:43:40.852025 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m20:43:40.854096 [debug] [ThreadPool]: On create_demo_analytics_analytics_staging: Close
[0m20:43:40.858895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_analytics_staging, now list_demo_analytics_analytics_analytics)
[0m20:43:40.870819 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m20:43:40.872376 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: BEGIN
[0m20:43:40.873823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:40.886457 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:43:40.888504 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_analytics"
[0m20:43:40.890281 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_analytics'
  
[0m20:43:40.896346 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:43:40.901556 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: ROLLBACK
[0m20:43:40.903782 [debug] [ThreadPool]: On list_demo_analytics_analytics_analytics: Close
[0m20:43:40.909140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_analytics, now list_demo_analytics_analytics_staging)
[0m20:43:40.915674 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m20:43:40.917617 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: BEGIN
[0m20:43:40.919343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:40.940107 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:43:40.942203 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics_staging"
[0m20:43:40.944302 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_staging'
  
[0m20:43:40.953427 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:43:40.957115 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: ROLLBACK
[0m20:43:40.959122 [debug] [ThreadPool]: On list_demo_analytics_analytics_staging: Close
[0m20:43:40.974270 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:40.977145 [debug] [MainThread]: On master: BEGIN
[0m20:43:40.979472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:43:40.997744 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:43:41.000260 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:41.002406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:43:41.012204 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:43:41.019145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154a9fc7-a0b8-4ff8-8d89-1098d85dfb23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa07d77c10>]}
[0m20:43:41.021773 [debug] [MainThread]: On master: ROLLBACK
[0m20:43:41.025178 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:41.027337 [debug] [MainThread]: On master: BEGIN
[0m20:43:41.029653 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:43:41.031378 [debug] [MainThread]: On master: COMMIT
[0m20:43:41.033130 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:41.034916 [debug] [MainThread]: On master: COMMIT
[0m20:43:41.036711 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:43:41.038421 [debug] [MainThread]: On master: Close
[0m20:43:41.041280 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:43:41.043854 [info ] [MainThread]: 
[0m20:43:41.065436 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m20:43:41.067466 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_analytics_staging.stg_transactions ...... [RUN]
[0m20:43:41.070090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics_staging, now model.retail_poc.stg_transactions)
[0m20:43:41.071773 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m20:43:41.086427 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m20:43:41.100507 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 20:43:41.073036 => 20:43:41.099012
[0m20:43:41.103744 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m20:43:41.288860 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m20:43:41.306911 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m20:43:41.309377 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m20:43:41.312230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:41.334562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:43:41.341971 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m20:43:41.347301 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo".analytics_analytics_staging."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m20:43:41.366124 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m20:43:41.398273 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m20:43:41.436129 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo".analytics_analytics_staging."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m20:43:41.459586 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:43:41.553969 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m20:43:41.557986 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m20:43:41.562156 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m20:43:41.567640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:43:41.593890 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics_staging."stg_transactions__dbt_backup"
[0m20:43:41.614068 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m20:43:41.616133 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo".analytics_analytics_staging."stg_transactions__dbt_backup" cascade
[0m20:43:41.619037 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:43:41.623781 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 20:43:41.105688 => 20:43:41.623129
[0m20:43:41.626196 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m20:43:41.629595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154a9fc7-a0b8-4ff8-8d89-1098d85dfb23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa06636fd0>]}
[0m20:43:41.632589 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_analytics_staging.stg_transactions . [[32mSELECT 0[0m in 0.56s]
[0m20:43:41.635926 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m20:43:41.640525 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m20:43:41.642794 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics_analytics.fact_orders ......... [RUN]
[0m20:43:41.645730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m20:43:41.648149 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m20:43:41.657063 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m20:43:41.675095 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 20:43:41.649749 => 20:43:41.674158
[0m20:43:41.679180 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m20:43:41.700592 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m20:43:41.716872 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m20:43:41.719108 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m20:43:41.721327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:41.739061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:43:41.741520 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m20:43:41.744803 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo".analytics_analytics_analytics."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo".analytics_analytics_staging."stg_transactions"
WHERE status = 'completed'   -- optional filter for valid orders
GROUP BY user_id
  );
  
[0m20:43:41.762034 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m20:43:41.773921 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m20:43:41.776909 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo".analytics_analytics_analytics."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:43:41.781540 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:43:41.789472 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m20:43:41.792182 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m20:43:41.795719 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m20:43:41.800362 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:43:41.811039 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics_analytics."fact_orders__dbt_backup"
[0m20:43:41.814975 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m20:43:41.817835 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo".analytics_analytics_analytics."fact_orders__dbt_backup" cascade
[0m20:43:41.820984 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:43:41.826483 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 20:43:41.683794 => 20:43:41.825928
[0m20:43:41.829649 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m20:43:41.832789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154a9fc7-a0b8-4ff8-8d89-1098d85dfb23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa06535890>]}
[0m20:43:41.836849 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics_analytics.fact_orders .... [[32mSELECT 0[0m in 0.19s]
[0m20:43:41.839562 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m20:43:41.845277 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:41.847366 [debug] [MainThread]: On master: BEGIN
[0m20:43:41.850411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:43:41.874325 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:43:41.876585 [debug] [MainThread]: On master: COMMIT
[0m20:43:41.879601 [debug] [MainThread]: Using postgres connection "master"
[0m20:43:41.881632 [debug] [MainThread]: On master: COMMIT
[0m20:43:41.883895 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:43:41.885750 [debug] [MainThread]: On master: Close
[0m20:43:41.889026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:41.891271 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m20:43:41.893228 [info ] [MainThread]: 
[0m20:43:41.895338 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m20:43:41.898742 [debug] [MainThread]: Command end result
[0m20:43:41.940709 [info ] [MainThread]: 
[0m20:43:41.942842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:43:41.944790 [info ] [MainThread]: 
[0m20:43:41.946547 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:43:41.949697 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.3167143, "process_user_time": 5.059852, "process_kernel_time": 0.615119, "process_mem_max_rss": "110164", "process_out_blocks": "96", "process_in_blocks": "0"}
[0m20:43:41.952229 [debug] [MainThread]: Command `dbt run` succeeded at 20:43:41.951890 after 2.32 seconds
[0m20:43:41.954029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa07e8fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa07e8d4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0bca0890>]}
[0m20:43:41.955736 [debug] [MainThread]: Flushing usage events
[0m20:45:12.115357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0a681110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0a6a6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0a683890>]}


============================== 20:45:12.121124 | 5d7796cc-6811-491a-a1f4-dbf16ba1b1b1 ==============================
[0m20:45:12.121124 [info ] [MainThread]: Running with dbt=1.7.16
[0m20:45:12.123490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:45:12.126510 [info ] [MainThread]: dbt version: 1.7.16
[0m20:45:12.128300 [info ] [MainThread]: python version: 3.11.2
[0m20:45:12.130148 [info ] [MainThread]: python path: /usr/local/bin/python
[0m20:45:12.131815 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m20:45:12.309072 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m20:45:12.310983 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m20:45:12.312746 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m20:45:12.314692 [info ] [MainThread]: adapter type: postgres
[0m20:45:12.316604 [info ] [MainThread]: adapter version: 1.7.16
[0m20:45:12.470025 [info ] [MainThread]: Configuration:
[0m20:45:12.471743 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:45:12.473309 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:45:12.474809 [info ] [MainThread]: Required dependencies:
[0m20:45:12.476301 [debug] [MainThread]: Executing "git --help"
[0m20:45:12.479591 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:45:12.481240 [debug] [MainThread]: STDERR: "b''"
[0m20:45:12.482641 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:45:12.484038 [info ] [MainThread]: Connection:
[0m20:45:12.485497 [info ] [MainThread]:   host: postgres
[0m20:45:12.486793 [info ] [MainThread]:   port: 5432
[0m20:45:12.488216 [info ] [MainThread]:   user: demo
[0m20:45:12.489707 [info ] [MainThread]:   database: demo
[0m20:45:12.491163 [info ] [MainThread]:   schema: analytics
[0m20:45:12.492662 [info ] [MainThread]:   connect_timeout: 10
[0m20:45:12.494048 [info ] [MainThread]:   role: None
[0m20:45:12.495362 [info ] [MainThread]:   search_path: None
[0m20:45:12.496783 [info ] [MainThread]:   keepalives_idle: 0
[0m20:45:12.498131 [info ] [MainThread]:   sslmode: None
[0m20:45:12.499463 [info ] [MainThread]:   sslcert: None
[0m20:45:12.500834 [info ] [MainThread]:   sslkey: None
[0m20:45:12.502167 [info ] [MainThread]:   sslrootcert: None
[0m20:45:12.503639 [info ] [MainThread]:   application_name: dbt
[0m20:45:12.505256 [info ] [MainThread]:   retries: 1
[0m20:45:12.506807 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m20:45:12.508659 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:45:12.510213 [debug] [MainThread]: Using postgres connection "debug"
[0m20:45:12.511643 [debug] [MainThread]: On debug: select 1 as id
[0m20:45:12.513017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:12.527643 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m20:45:12.530232 [debug] [MainThread]: On debug: Close
[0m20:45:12.531949 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:45:12.533864 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:45:12.536448 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5230188, "process_user_time": 3.554067, "process_kernel_time": 0.100681, "process_mem_max_rss": "102276", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:45:12.538224 [debug] [MainThread]: Command `dbt debug` succeeded at 20:45:12.537870 after 0.52 seconds
[0m20:45:12.539917 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:45:12.541228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0a5bc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0a500dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca0bb61b50>]}
[0m20:45:12.542655 [debug] [MainThread]: Flushing usage events
[0m20:45:17.554248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff480005010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47fffd750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff480005490>]}


============================== 20:45:17.559548 | 77b4e839-1ecb-4372-ac98-d5f74aaef090 ==============================
[0m20:45:17.559548 [info ] [MainThread]: Running with dbt=1.7.16
[0m20:45:17.561649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:45:17.903869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77b4e839-1ecb-4372-ac98-d5f74aaef090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47e70e710>]}
[0m20:45:18.007949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77b4e839-1ecb-4372-ac98-d5f74aaef090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47e717890>]}
[0m20:45:18.010526 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m20:45:18.037057 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m20:45:18.179198 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m20:45:18.181187 [debug] [MainThread]: Partial parsing: deleted file: retail_poc://macros/generate_schema_name.sql
[0m20:45:18.183186 [debug] [MainThread]: Partial parsing: updated file: retail_poc://models/marts/fact_orders.sql
[0m20:45:18.185034 [debug] [MainThread]: Partial parsing: updated file: retail_poc://models/staging/stg_transactions.sql
[0m20:45:18.481451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77b4e839-1ecb-4372-ac98-d5f74aaef090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47e3e6ed0>]}
[0m20:45:18.527479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77b4e839-1ecb-4372-ac98-d5f74aaef090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47e439990>]}
[0m20:45:18.530809 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m20:45:18.532957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77b4e839-1ecb-4372-ac98-d5f74aaef090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47e5a2210>]}
[0m20:45:18.539222 [info ] [MainThread]: 
[0m20:45:18.543644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:45:18.548028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m20:45:18.571557 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m20:45:18.573518 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m20:45:18.575080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:18.590586 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:45:18.594368 [debug] [ThreadPool]: On list_demo: Close
[0m20:45:18.600387 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m20:45:18.602415 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m20:45:18.603943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:18.618346 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m20:45:18.622022 [debug] [ThreadPool]: On list_demo: Close
[0m20:45:18.625437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_analytics_staging)
[0m20:45:18.627718 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_staging"
"
[0m20:45:18.639034 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_staging"
[0m20:45:18.640528 [debug] [ThreadPool]: On create_demo_analytics_staging: BEGIN
[0m20:45:18.641923 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:18.655497 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:45:18.657191 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_staging"
[0m20:45:18.658636 [debug] [ThreadPool]: On create_demo_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_staging"} */
create schema if not exists analytics_staging
[0m20:45:18.660668 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m20:45:18.663074 [debug] [ThreadPool]: On create_demo_analytics_staging: COMMIT
[0m20:45:18.664481 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_staging"
[0m20:45:18.665877 [debug] [ThreadPool]: On create_demo_analytics_staging: COMMIT
[0m20:45:18.669426 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m20:45:18.670741 [debug] [ThreadPool]: On create_demo_analytics_staging: Close
[0m20:45:18.674215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_staging, now create_demo_analytics_analytics)
[0m20:45:18.676393 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_analytics"
"
[0m20:45:18.681514 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics"
[0m20:45:18.683030 [debug] [ThreadPool]: On create_demo_analytics_analytics: BEGIN
[0m20:45:18.684376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:18.697983 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:45:18.699977 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics"
[0m20:45:18.701556 [debug] [ThreadPool]: On create_demo_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_analytics"} */
create schema if not exists analytics_analytics
[0m20:45:18.703867 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m20:45:18.706425 [debug] [ThreadPool]: On create_demo_analytics_analytics: COMMIT
[0m20:45:18.708311 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics"
[0m20:45:18.709904 [debug] [ThreadPool]: On create_demo_analytics_analytics: COMMIT
[0m20:45:18.712984 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m20:45:18.714368 [debug] [ThreadPool]: On create_demo_analytics_analytics: Close
[0m20:45:18.718863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_analytics, now list_demo_analytics_staging)
[0m20:45:18.730178 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m20:45:18.732028 [debug] [ThreadPool]: On list_demo_analytics_staging: BEGIN
[0m20:45:18.733607 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:18.745848 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:45:18.747786 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m20:45:18.749724 [debug] [ThreadPool]: On list_demo_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m20:45:18.755128 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:45:18.758477 [debug] [ThreadPool]: On list_demo_analytics_staging: ROLLBACK
[0m20:45:18.760506 [debug] [ThreadPool]: On list_demo_analytics_staging: Close
[0m20:45:18.763565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_staging, now list_demo_analytics_analytics)
[0m20:45:18.768318 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m20:45:18.769994 [debug] [ThreadPool]: On list_demo_analytics_analytics: BEGIN
[0m20:45:18.771578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:18.788033 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:45:18.790740 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m20:45:18.792486 [debug] [ThreadPool]: On list_demo_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m20:45:18.797811 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m20:45:18.800964 [debug] [ThreadPool]: On list_demo_analytics_analytics: ROLLBACK
[0m20:45:18.803254 [debug] [ThreadPool]: On list_demo_analytics_analytics: Close
[0m20:45:18.811924 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:18.813715 [debug] [MainThread]: On master: BEGIN
[0m20:45:18.815240 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:18.829661 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:45:18.831636 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:18.833521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:45:18.840654 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m20:45:18.844151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77b4e839-1ecb-4372-ac98-d5f74aaef090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47e60c410>]}
[0m20:45:18.846004 [debug] [MainThread]: On master: ROLLBACK
[0m20:45:18.847895 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:18.849622 [debug] [MainThread]: On master: BEGIN
[0m20:45:18.851680 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:45:18.853186 [debug] [MainThread]: On master: COMMIT
[0m20:45:18.854509 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:18.855807 [debug] [MainThread]: On master: COMMIT
[0m20:45:18.857429 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:45:18.858892 [debug] [MainThread]: On master: Close
[0m20:45:18.861054 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:45:18.862912 [info ] [MainThread]: 
[0m20:45:18.868514 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m20:45:18.870510 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_staging.stg_transactions ................ [RUN]
[0m20:45:18.872865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics, now model.retail_poc.stg_transactions)
[0m20:45:18.874530 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m20:45:18.888455 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m20:45:18.901627 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 20:45:18.876015 => 20:45:18.901070
[0m20:45:18.903283 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m20:45:18.974761 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m20:45:18.989117 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m20:45:18.990821 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m20:45:18.992476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:19.004579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:19.006598 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m20:45:19.008313 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo".analytics_staging."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m20:45:19.819808 [debug] [Thread-1 (]: SQL status: SELECT 500000 in 1.0 seconds
[0m20:45:19.832093 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m20:45:19.834874 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo".analytics_staging."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m20:45:19.837537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:19.870974 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m20:45:19.873520 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m20:45:19.875697 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m20:45:19.891261 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:45:19.903806 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_staging."stg_transactions__dbt_backup"
[0m20:45:19.914522 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m20:45:19.916841 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo".analytics_staging."stg_transactions__dbt_backup" cascade
[0m20:45:19.919726 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:45:19.924863 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 20:45:18.904519 => 20:45:19.924244
[0m20:45:19.926974 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m20:45:19.929509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77b4e839-1ecb-4372-ac98-d5f74aaef090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47e64fe90>]}
[0m20:45:19.931854 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_staging.stg_transactions ........... [[32mSELECT 500000[0m in 1.06s]
[0m20:45:19.934447 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m20:45:19.937814 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m20:45:19.939604 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics.fact_orders ................... [RUN]
[0m20:45:19.942148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m20:45:19.944088 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m20:45:19.950585 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m20:45:19.964397 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 20:45:19.945356 => 20:45:19.963832
[0m20:45:19.966022 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m20:45:19.975519 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m20:45:19.988907 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m20:45:19.990833 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m20:45:19.992634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:20.005654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:45:20.007704 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m20:45:20.009599 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo".analytics_analytics."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo".analytics_staging."stg_transactions"
WHERE status = 'completed'   -- optional filter for valid orders
GROUP BY user_id
  );
  
[0m20:45:21.560119 [debug] [Thread-1 (]: SQL status: SELECT 79808 in 2.0 seconds
[0m20:45:21.567006 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m20:45:21.568985 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo".analytics_analytics."fact_orders__dbt_tmp" rename to "fact_orders"
[0m20:45:21.571087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:45:21.575626 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m20:45:21.577386 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m20:45:21.579038 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m20:45:21.586404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:45:21.592510 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics."fact_orders__dbt_backup"
[0m20:45:21.595243 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m20:45:21.597045 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo".analytics_analytics."fact_orders__dbt_backup" cascade
[0m20:45:21.599211 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m20:45:21.602948 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 20:45:19.967350 => 20:45:21.602593
[0m20:45:21.604812 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m20:45:21.607252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77b4e839-1ecb-4372-ac98-d5f74aaef090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff47e456750>]}
[0m20:45:21.609675 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics.fact_orders .............. [[32mSELECT 79808[0m in 1.67s]
[0m20:45:21.611866 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m20:45:21.615674 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:21.617405 [debug] [MainThread]: On master: BEGIN
[0m20:45:21.619175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:45:21.631629 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:45:21.633477 [debug] [MainThread]: On master: COMMIT
[0m20:45:21.635142 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:21.636859 [debug] [MainThread]: On master: COMMIT
[0m20:45:21.638872 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:45:21.640835 [debug] [MainThread]: On master: Close
[0m20:45:21.643221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:21.644676 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m20:45:21.646184 [info ] [MainThread]: 
[0m20:45:21.647779 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m20:45:21.650302 [debug] [MainThread]: Command end result
[0m20:45:21.679967 [info ] [MainThread]: 
[0m20:45:21.681618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:45:21.683231 [info ] [MainThread]: 
[0m20:45:21.684963 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:45:21.687586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.229764, "process_user_time": 4.782453, "process_kernel_time": 0.190496, "process_mem_max_rss": "112796", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:45:21.689647 [debug] [MainThread]: Command `dbt run` succeeded at 20:45:21.689373 after 4.23 seconds
[0m20:45:21.691390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff483e1c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff48046dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff483ee8550>]}
[0m20:45:21.692989 [debug] [MainThread]: Flushing usage events
[0m21:16:57.859622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82035fb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8203ab1990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8203455610>]}


============================== 21:16:57.866498 | 2db9f6f6-c4a9-4834-8222-e2de73b9f5c4 ==============================
[0m21:16:57.866498 [info ] [MainThread]: Running with dbt=1.7.16
[0m21:16:57.868890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:16:58.354011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2db9f6f6-c4a9-4834-8222-e2de73b9f5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8203458410>]}
[0m21:16:58.506136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2db9f6f6-c4a9-4834-8222-e2de73b9f5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8201c10550>]}
[0m21:16:58.508629 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m21:16:58.538314 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m21:16:58.691380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:16:58.694323 [debug] [MainThread]: Partial parsing: updated file: retail_poc://models/marts/fact_orders.sql
[0m21:16:59.220524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2db9f6f6-c4a9-4834-8222-e2de73b9f5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8201bc1b50>]}
[0m21:16:59.276116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2db9f6f6-c4a9-4834-8222-e2de73b9f5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8201ae3610>]}
[0m21:16:59.279437 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:16:59.282468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2db9f6f6-c4a9-4834-8222-e2de73b9f5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8201a41390>]}
[0m21:16:59.288846 [info ] [MainThread]: 
[0m21:16:59.293483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:16:59.299185 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m21:16:59.328609 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m21:16:59.332398 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m21:16:59.335120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:59.353117 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:16:59.356506 [debug] [ThreadPool]: On list_demo: Close
[0m21:16:59.362866 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m21:16:59.364764 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m21:16:59.366608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:59.382113 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:16:59.385899 [debug] [ThreadPool]: On list_demo: Close
[0m21:16:59.390252 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now list_demo_analytics_staging)
[0m21:16:59.402155 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m21:16:59.403942 [debug] [ThreadPool]: On list_demo_analytics_staging: BEGIN
[0m21:16:59.405559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:59.418501 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:16:59.420172 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m21:16:59.421917 [debug] [ThreadPool]: On list_demo_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:16:59.430425 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:16:59.433716 [debug] [ThreadPool]: On list_demo_analytics_staging: ROLLBACK
[0m21:16:59.435749 [debug] [ThreadPool]: On list_demo_analytics_staging: Close
[0m21:16:59.439234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_staging, now list_demo_analytics_analytics)
[0m21:16:59.445443 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m21:16:59.447925 [debug] [ThreadPool]: On list_demo_analytics_analytics: BEGIN
[0m21:16:59.450157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:59.468128 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:16:59.470342 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m21:16:59.472332 [debug] [ThreadPool]: On list_demo_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m21:16:59.478968 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:16:59.482539 [debug] [ThreadPool]: On list_demo_analytics_analytics: ROLLBACK
[0m21:16:59.485053 [debug] [ThreadPool]: On list_demo_analytics_analytics: Close
[0m21:16:59.497328 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:59.499323 [debug] [MainThread]: On master: BEGIN
[0m21:16:59.500741 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:59.513759 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:16:59.515760 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:59.517371 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:16:59.524453 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:16:59.528012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2db9f6f6-c4a9-4834-8222-e2de73b9f5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8201aa9ad0>]}
[0m21:16:59.529820 [debug] [MainThread]: On master: ROLLBACK
[0m21:16:59.531707 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:59.533257 [debug] [MainThread]: On master: BEGIN
[0m21:16:59.535262 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:16:59.536683 [debug] [MainThread]: On master: COMMIT
[0m21:16:59.538291 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:59.539716 [debug] [MainThread]: On master: COMMIT
[0m21:16:59.541535 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:16:59.542956 [debug] [MainThread]: On master: Close
[0m21:16:59.545573 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:59.547705 [info ] [MainThread]: 
[0m21:16:59.553352 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m21:16:59.555500 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_staging.stg_transactions ................ [RUN]
[0m21:16:59.558312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics, now model.retail_poc.stg_transactions)
[0m21:16:59.560732 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m21:16:59.579592 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m21:16:59.598673 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 21:16:59.562756 => 21:16:59.597996
[0m21:16:59.600791 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m21:16:59.673278 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m21:16:59.686740 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:16:59.688641 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m21:16:59.690211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:59.702716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:16:59.704694 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:16:59.706497 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo".analytics_staging."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m21:17:02.138848 [debug] [Thread-1 (]: SQL status: SELECT 1500000 in 2.0 seconds
[0m21:17:02.150434 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:17:02.152517 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_staging"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m21:17:02.154882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:17:02.164176 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:17:02.166212 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo".analytics_staging."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m21:17:02.168561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:17:02.204962 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m21:17:02.207169 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:17:02.209003 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m21:17:02.216305 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:17:02.228583 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_staging."stg_transactions__dbt_backup"
[0m21:17:02.239439 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:17:02.241232 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo".analytics_staging."stg_transactions__dbt_backup" cascade
[0m21:17:02.253799 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:17:02.257859 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 21:16:59.602511 => 21:17:02.257484
[0m21:17:02.259736 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m21:17:02.262380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2db9f6f6-c4a9-4834-8222-e2de73b9f5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82035fadd0>]}
[0m21:17:02.265285 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_staging.stg_transactions ........... [[32mSELECT 1500000[0m in 2.70s]
[0m21:17:02.268111 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m21:17:02.274138 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m21:17:02.276290 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics.fact_orders ................... [RUN]
[0m21:17:02.281290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m21:17:02.283409 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m21:17:02.290885 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m21:17:02.308181 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 21:17:02.284727 => 21:17:02.306864
[0m21:17:02.310395 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m21:17:02.326081 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m21:17:02.340774 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:17:02.342692 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m21:17:02.344316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:02.361007 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:17:02.362870 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:17:02.364473 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo".analytics_analytics."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    status,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo".analytics_staging."stg_transactions"
WHERE status = 'completed'
GROUP BY user_id, status
  );
  
[0m21:17:06.656150 [debug] [Thread-1 (]: SQL status: SELECT 80000 in 4.0 seconds
[0m21:17:06.663302 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:17:06.665251 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics"."fact_orders" rename to "fact_orders__dbt_backup"
[0m21:17:06.667604 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:17:06.674130 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:17:06.676181 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo".analytics_analytics."fact_orders__dbt_tmp" rename to "fact_orders"
[0m21:17:06.678476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:17:06.683397 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m21:17:06.685092 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:17:06.686536 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m21:17:06.691596 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:17:06.697220 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics."fact_orders__dbt_backup"
[0m21:17:06.699752 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:17:06.701522 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo".analytics_analytics."fact_orders__dbt_backup" cascade
[0m21:17:06.707823 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:17:06.711796 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 21:17:02.312819 => 21:17:06.711392
[0m21:17:06.713822 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m21:17:06.716369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2db9f6f6-c4a9-4834-8222-e2de73b9f5c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8201c05510>]}
[0m21:17:06.718678 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics.fact_orders .............. [[32mSELECT 80000[0m in 4.44s]
[0m21:17:06.720943 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m21:17:06.725322 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:06.726832 [debug] [MainThread]: On master: BEGIN
[0m21:17:06.728199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:17:06.740388 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:17:06.742058 [debug] [MainThread]: On master: COMMIT
[0m21:17:06.743762 [debug] [MainThread]: Using postgres connection "master"
[0m21:17:06.745517 [debug] [MainThread]: On master: COMMIT
[0m21:17:06.748119 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:17:06.749763 [debug] [MainThread]: On master: Close
[0m21:17:06.751920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:06.754015 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m21:17:06.757318 [info ] [MainThread]: 
[0m21:17:06.759711 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.46 seconds (7.46s).
[0m21:17:06.765033 [debug] [MainThread]: Command end result
[0m21:17:06.804738 [info ] [MainThread]: 
[0m21:17:06.807410 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:17:06.809899 [info ] [MainThread]: 
[0m21:17:06.813398 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:17:06.817341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.086104, "process_user_time": 5.176964, "process_kernel_time": 0.21151, "process_mem_max_rss": "111612", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:17:06.822699 [debug] [MainThread]: Command `dbt run` succeeded at 21:17:06.821981 after 9.09 seconds
[0m21:17:06.825230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8203455290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82074ec590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8201a93650>]}
[0m21:17:06.827370 [debug] [MainThread]: Flushing usage events
[0m21:20:29.707998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f188d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f18b2a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f253dd50>]}


============================== 21:20:29.713107 | 8e2a03c6-b907-4f08-a0f1-b13fa612a338 ==============================
[0m21:20:29.713107 [info ] [MainThread]: Running with dbt=1.7.16
[0m21:20:29.715063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:20:29.717956 [info ] [MainThread]: dbt version: 1.7.16
[0m21:20:29.719536 [info ] [MainThread]: python version: 3.11.2
[0m21:20:29.721040 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:20:29.722436 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m21:20:29.867106 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m21:20:29.869403 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m21:20:29.871284 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m21:20:29.873900 [info ] [MainThread]: adapter type: postgres
[0m21:20:29.875811 [info ] [MainThread]: adapter version: 1.7.16
[0m21:20:30.044244 [info ] [MainThread]: Configuration:
[0m21:20:30.046588 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:20:30.048572 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:20:30.050323 [info ] [MainThread]: Required dependencies:
[0m21:20:30.052368 [debug] [MainThread]: Executing "git --help"
[0m21:20:30.060135 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:20:30.062785 [debug] [MainThread]: STDERR: "b''"
[0m21:20:30.064712 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:20:30.066529 [info ] [MainThread]: Connection:
[0m21:20:30.068197 [info ] [MainThread]:   host: postgres
[0m21:20:30.070685 [info ] [MainThread]:   port: 5432
[0m21:20:30.072292 [info ] [MainThread]:   user: demo
[0m21:20:30.073862 [info ] [MainThread]:   database: demo
[0m21:20:30.075357 [info ] [MainThread]:   schema: analytics
[0m21:20:30.076760 [info ] [MainThread]:   connect_timeout: 10
[0m21:20:30.078638 [info ] [MainThread]:   role: None
[0m21:20:30.080711 [info ] [MainThread]:   search_path: None
[0m21:20:30.083044 [info ] [MainThread]:   keepalives_idle: 0
[0m21:20:30.086319 [info ] [MainThread]:   sslmode: None
[0m21:20:30.088612 [info ] [MainThread]:   sslcert: None
[0m21:20:30.090617 [info ] [MainThread]:   sslkey: None
[0m21:20:30.092763 [info ] [MainThread]:   sslrootcert: None
[0m21:20:30.095094 [info ] [MainThread]:   application_name: dbt
[0m21:20:30.097371 [info ] [MainThread]:   retries: 1
[0m21:20:30.099329 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m21:20:30.101250 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:20:30.102918 [debug] [MainThread]: Using postgres connection "debug"
[0m21:20:30.104657 [debug] [MainThread]: On debug: select 1 as id
[0m21:20:30.106644 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:30.128728 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:30.133489 [debug] [MainThread]: On debug: Close
[0m21:20:30.135669 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:20:30.137763 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:20:30.140737 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.54668933, "process_user_time": 4.182441, "process_kernel_time": 0.260151, "process_mem_max_rss": "102344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:20:30.142904 [debug] [MainThread]: Command `dbt debug` succeeded at 21:20:30.142549 after 0.55 seconds
[0m21:20:30.144912 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:20:30.146907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f1703f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f1703490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f17baa10>]}
[0m21:20:30.148953 [debug] [MainThread]: Flushing usage events
[0m21:20:34.873961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871103db90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8711035210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871103d350>]}


============================== 21:20:34.880551 | f1f68f93-5196-43f6-82e8-4dee4a8a70ac ==============================
[0m21:20:34.880551 [info ] [MainThread]: Running with dbt=1.7.16
[0m21:20:34.883011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:20:35.181066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1f68f93-5196-43f6-82e8-4dee4a8a70ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8710f2b990>]}
[0m21:20:35.283184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1f68f93-5196-43f6-82e8-4dee4a8a70ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f870f74da90>]}
[0m21:20:35.286088 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m21:20:35.311414 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m21:20:35.469099 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:35.471087 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:35.482005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1f68f93-5196-43f6-82e8-4dee4a8a70ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8711ca4310>]}
[0m21:20:35.520828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1f68f93-5196-43f6-82e8-4dee4a8a70ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f870f638910>]}
[0m21:20:35.522919 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:20:35.524716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1f68f93-5196-43f6-82e8-4dee4a8a70ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f870f628e10>]}
[0m21:20:35.528525 [info ] [MainThread]: 
[0m21:20:35.531509 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:20:35.535586 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m21:20:35.555332 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m21:20:35.557243 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m21:20:35.559255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:35.574284 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:20:35.578002 [debug] [ThreadPool]: On list_demo: Close
[0m21:20:35.584222 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m21:20:35.586023 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m21:20:35.587657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:35.600734 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:20:35.604449 [debug] [ThreadPool]: On list_demo: Close
[0m21:20:35.608489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now list_demo_analytics_analytics)
[0m21:20:35.619538 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m21:20:35.621245 [debug] [ThreadPool]: On list_demo_analytics_analytics: BEGIN
[0m21:20:35.622937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:35.635167 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:20:35.637033 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m21:20:35.638662 [debug] [ThreadPool]: On list_demo_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m21:20:35.644139 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:35.647179 [debug] [ThreadPool]: On list_demo_analytics_analytics: ROLLBACK
[0m21:20:35.649037 [debug] [ThreadPool]: On list_demo_analytics_analytics: Close
[0m21:20:35.651947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics, now list_demo_analytics_staging)
[0m21:20:35.656879 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m21:20:35.658465 [debug] [ThreadPool]: On list_demo_analytics_staging: BEGIN
[0m21:20:35.660035 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:35.672135 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:20:35.674211 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m21:20:35.676052 [debug] [ThreadPool]: On list_demo_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:20:35.681478 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:20:35.684453 [debug] [ThreadPool]: On list_demo_analytics_staging: ROLLBACK
[0m21:20:35.686414 [debug] [ThreadPool]: On list_demo_analytics_staging: Close
[0m21:20:35.695626 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:35.697459 [debug] [MainThread]: On master: BEGIN
[0m21:20:35.699373 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:35.712023 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:20:35.714047 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:35.715982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:20:35.725685 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:20:35.729249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1f68f93-5196-43f6-82e8-4dee4a8a70ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8711ca40d0>]}
[0m21:20:35.731238 [debug] [MainThread]: On master: ROLLBACK
[0m21:20:35.733732 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:35.735570 [debug] [MainThread]: On master: BEGIN
[0m21:20:35.737529 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:20:35.738946 [debug] [MainThread]: On master: COMMIT
[0m21:20:35.740385 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:35.741747 [debug] [MainThread]: On master: COMMIT
[0m21:20:35.743298 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:20:35.744652 [debug] [MainThread]: On master: Close
[0m21:20:35.746823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:20:35.748621 [info ] [MainThread]: 
[0m21:20:35.753378 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m21:20:35.755114 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_staging.stg_transactions ................ [RUN]
[0m21:20:35.757246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_staging, now model.retail_poc.stg_transactions)
[0m21:20:35.758721 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m21:20:35.772750 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m21:20:35.783950 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 21:20:35.759933 => 21:20:35.783461
[0m21:20:35.785488 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m21:20:35.860851 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m21:20:35.874108 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:20:35.875805 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m21:20:35.877350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:35.889429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:35.891715 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:20:35.893466 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo".analytics_staging."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m21:20:38.167324 [debug] [Thread-1 (]: SQL status: SELECT 1500000 in 2.0 seconds
[0m21:20:38.179657 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:20:38.181612 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_staging"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m21:20:38.183910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:38.190391 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:20:38.191934 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo".analytics_staging."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m21:20:38.193999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:38.236287 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m21:20:38.238394 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:20:38.240383 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m21:20:38.251980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:20:38.266997 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_staging."stg_transactions__dbt_backup"
[0m21:20:38.277520 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:20:38.279882 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo".analytics_staging."stg_transactions__dbt_backup" cascade
[0m21:20:38.306991 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:20:38.311598 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 21:20:35.786690 => 21:20:38.311233
[0m21:20:38.313564 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m21:20:38.316269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f68f93-5196-43f6-82e8-4dee4a8a70ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f870f7ce690>]}
[0m21:20:38.318583 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_staging.stg_transactions ........... [[32mSELECT 1500000[0m in 2.56s]
[0m21:20:38.320684 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m21:20:38.323198 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m21:20:38.324967 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics.fact_orders ................... [RUN]
[0m21:20:38.327132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m21:20:38.328669 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m21:20:38.335032 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m21:20:38.346979 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 21:20:38.330015 => 21:20:38.346459
[0m21:20:38.348626 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m21:20:38.359668 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m21:20:38.371312 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:20:38.372956 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m21:20:38.374389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:38.385876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:20:38.387813 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:20:38.389788 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo".analytics_analytics."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    status,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo".analytics_staging."stg_transactions"
WHERE status = 'completed'
GROUP BY user_id, status
  );
  
[0m21:20:42.740595 [debug] [Thread-1 (]: SQL status: SELECT 80000 in 4.0 seconds
[0m21:20:42.749529 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:20:42.751888 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics"."fact_orders" rename to "fact_orders__dbt_backup"
[0m21:20:42.754384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:42.761468 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:20:42.763703 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo".analytics_analytics."fact_orders__dbt_tmp" rename to "fact_orders"
[0m21:20:42.766211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:20:42.771420 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m21:20:42.773304 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:20:42.775088 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m21:20:42.781353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:20:42.787165 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics."fact_orders__dbt_backup"
[0m21:20:42.789743 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:20:42.791340 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo".analytics_analytics."fact_orders__dbt_backup" cascade
[0m21:20:42.797929 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:20:42.802013 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 21:20:38.349870 => 21:20:42.801630
[0m21:20:42.803828 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m21:20:42.806801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1f68f93-5196-43f6-82e8-4dee4a8a70ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f870f417a10>]}
[0m21:20:42.809442 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics.fact_orders .............. [[32mSELECT 80000[0m in 4.48s]
[0m21:20:42.811841 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m21:20:42.816003 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:42.817768 [debug] [MainThread]: On master: BEGIN
[0m21:20:42.819361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:20:42.833616 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:20:42.835795 [debug] [MainThread]: On master: COMMIT
[0m21:20:42.837675 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:42.839494 [debug] [MainThread]: On master: COMMIT
[0m21:20:42.841860 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:20:42.843669 [debug] [MainThread]: On master: Close
[0m21:20:42.846677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:42.848747 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m21:20:42.850939 [info ] [MainThread]: 
[0m21:20:42.852990 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 7.32 seconds (7.32s).
[0m21:20:42.856147 [debug] [MainThread]: Command end result
[0m21:20:42.897296 [info ] [MainThread]: 
[0m21:20:42.899425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:20:42.901215 [info ] [MainThread]: 
[0m21:20:42.903217 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:20:42.906177 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.149359, "process_user_time": 4.435235, "process_kernel_time": 0.217316, "process_mem_max_rss": "108832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:20:42.908619 [debug] [MainThread]: Command `dbt run` succeeded at 21:20:42.908237 after 8.15 seconds
[0m21:20:42.910757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f871137eb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8711041950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8714e54890>]}
[0m21:20:42.912934 [debug] [MainThread]: Flushing usage events
[0m21:26:26.116420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa459fbb010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa459fb8290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa459fb9590>]}


============================== 21:26:26.121431 | 159a1fbc-ae27-4d91-ad98-523e843bdaa1 ==============================
[0m21:26:26.121431 [info ] [MainThread]: Running with dbt=1.7.16
[0m21:26:26.123117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:26:26.125573 [info ] [MainThread]: dbt version: 1.7.16
[0m21:26:26.126999 [info ] [MainThread]: python version: 3.11.2
[0m21:26:26.128403 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:26:26.129821 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m21:26:26.256641 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m21:26:26.258634 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m21:26:26.260314 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m21:26:26.261992 [info ] [MainThread]: adapter type: postgres
[0m21:26:26.263455 [info ] [MainThread]: adapter version: 1.7.16
[0m21:26:26.431014 [info ] [MainThread]: Configuration:
[0m21:26:26.433501 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:26:26.435615 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:26:26.440404 [info ] [MainThread]: Required dependencies:
[0m21:26:26.443055 [debug] [MainThread]: Executing "git --help"
[0m21:26:26.447930 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:26:26.450560 [debug] [MainThread]: STDERR: "b''"
[0m21:26:26.452603 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:26:26.454279 [info ] [MainThread]: Connection:
[0m21:26:26.455831 [info ] [MainThread]:   host: postgres
[0m21:26:26.457346 [info ] [MainThread]:   port: 5432
[0m21:26:26.459051 [info ] [MainThread]:   user: demo
[0m21:26:26.460822 [info ] [MainThread]:   database: demo
[0m21:26:26.463455 [info ] [MainThread]:   schema: analytics
[0m21:26:26.467440 [info ] [MainThread]:   connect_timeout: 10
[0m21:26:26.470554 [info ] [MainThread]:   role: None
[0m21:26:26.473510 [info ] [MainThread]:   search_path: None
[0m21:26:26.476186 [info ] [MainThread]:   keepalives_idle: 0
[0m21:26:26.478612 [info ] [MainThread]:   sslmode: None
[0m21:26:26.480761 [info ] [MainThread]:   sslcert: None
[0m21:26:26.483004 [info ] [MainThread]:   sslkey: None
[0m21:26:26.485177 [info ] [MainThread]:   sslrootcert: None
[0m21:26:26.486854 [info ] [MainThread]:   application_name: dbt
[0m21:26:26.488467 [info ] [MainThread]:   retries: 1
[0m21:26:26.490416 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m21:26:26.492528 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:26:26.494292 [debug] [MainThread]: Using postgres connection "debug"
[0m21:26:26.496303 [debug] [MainThread]: On debug: select 1 as id
[0m21:26:26.497792 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:26.519057 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:26:26.521885 [debug] [MainThread]: On debug: Close
[0m21:26:26.523555 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:26:26.525185 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:26:26.527683 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.51208895, "process_user_time": 4.013627, "process_kernel_time": 0.331954, "process_mem_max_rss": "102192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:26:26.529685 [debug] [MainThread]: Command `dbt debug` succeeded at 21:26:26.529419 after 0.51 seconds
[0m21:26:26.531257 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:26:26.532724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa458697d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa45a3baad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa45de98510>]}
[0m21:26:26.534433 [debug] [MainThread]: Flushing usage events
[0m21:26:31.712106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f14a8ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f14a8ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f15121590>]}


============================== 21:26:31.717306 | cd727b0f-7295-4e2b-aac8-63c18db1200a ==============================
[0m21:26:31.717306 [info ] [MainThread]: Running with dbt=1.7.16
[0m21:26:31.719326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:26:31.998377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd727b0f-7295-4e2b-aac8-63c18db1200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f13379e10>]}
[0m21:26:32.112051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd727b0f-7295-4e2b-aac8-63c18db1200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f133d50d0>]}
[0m21:26:32.114531 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m21:26:32.139412 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m21:26:32.313047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:26:32.314857 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:26:32.328432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd727b0f-7295-4e2b-aac8-63c18db1200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f14ac3190>]}
[0m21:26:32.378746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd727b0f-7295-4e2b-aac8-63c18db1200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f132d4990>]}
[0m21:26:32.382724 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:26:32.385110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd727b0f-7295-4e2b-aac8-63c18db1200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f132c0050>]}
[0m21:26:32.391605 [info ] [MainThread]: 
[0m21:26:32.396167 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:26:32.400787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m21:26:32.424640 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m21:26:32.426944 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m21:26:32.430190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:32.450355 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:26:32.454291 [debug] [ThreadPool]: On list_demo: Close
[0m21:26:32.461869 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m21:26:32.464887 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m21:26:32.466657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:32.482627 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:26:32.488063 [debug] [ThreadPool]: On list_demo: Close
[0m21:26:32.497305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now list_demo_analytics_staging)
[0m21:26:32.515221 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m21:26:32.517554 [debug] [ThreadPool]: On list_demo_analytics_staging: BEGIN
[0m21:26:32.520637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:32.535633 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:26:32.537514 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m21:26:32.539524 [debug] [ThreadPool]: On list_demo_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:26:32.549884 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:26:32.555712 [debug] [ThreadPool]: On list_demo_analytics_staging: ROLLBACK
[0m21:26:32.558512 [debug] [ThreadPool]: On list_demo_analytics_staging: Close
[0m21:26:32.561669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_staging, now list_demo_analytics_analytics)
[0m21:26:32.569162 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m21:26:32.571086 [debug] [ThreadPool]: On list_demo_analytics_analytics: BEGIN
[0m21:26:32.572695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:32.590061 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:26:32.591807 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m21:26:32.593645 [debug] [ThreadPool]: On list_demo_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m21:26:32.605085 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:26:32.608766 [debug] [ThreadPool]: On list_demo_analytics_analytics: ROLLBACK
[0m21:26:32.612598 [debug] [ThreadPool]: On list_demo_analytics_analytics: Close
[0m21:26:32.624030 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:32.625995 [debug] [MainThread]: On master: BEGIN
[0m21:26:32.627774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:32.646421 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:26:32.648411 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:32.650423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:26:32.659135 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:26:32.663140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd727b0f-7295-4e2b-aac8-63c18db1200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1324e410>]}
[0m21:26:32.666392 [debug] [MainThread]: On master: ROLLBACK
[0m21:26:32.668339 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:32.670274 [debug] [MainThread]: On master: BEGIN
[0m21:26:32.673573 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:26:32.675102 [debug] [MainThread]: On master: COMMIT
[0m21:26:32.676632 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:32.678896 [debug] [MainThread]: On master: COMMIT
[0m21:26:32.681220 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:26:32.682712 [debug] [MainThread]: On master: Close
[0m21:26:32.685573 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:26:32.688088 [info ] [MainThread]: 
[0m21:26:32.695211 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m21:26:32.697232 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_staging.stg_transactions ................ [RUN]
[0m21:26:32.701553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics, now model.retail_poc.stg_transactions)
[0m21:26:32.705082 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m21:26:32.723406 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m21:26:32.739992 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 21:26:32.708383 => 21:26:32.738915
[0m21:26:32.742788 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m21:26:32.824332 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m21:26:32.841378 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:26:32.843088 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m21:26:32.845242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:32.859841 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:26:32.862161 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:26:32.864079 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo".analytics_staging."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m21:26:35.887897 [debug] [Thread-1 (]: SQL status: SELECT 2000000 in 3.0 seconds
[0m21:26:35.900382 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:26:35.902317 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_staging"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m21:26:35.904846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:26:35.911933 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:26:35.913752 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo".analytics_staging."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m21:26:35.915932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:26:35.953630 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m21:26:35.955405 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:26:35.956906 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m21:26:35.960988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:26:35.976199 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_staging."stg_transactions__dbt_backup"
[0m21:26:35.989645 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:26:35.991499 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo".analytics_staging."stg_transactions__dbt_backup" cascade
[0m21:26:36.025069 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:26:36.029296 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 21:26:32.744158 => 21:26:36.028860
[0m21:26:36.031205 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m21:26:36.033876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd727b0f-7295-4e2b-aac8-63c18db1200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f130cd850>]}
[0m21:26:36.036354 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_staging.stg_transactions ........... [[32mSELECT 2000000[0m in 3.33s]
[0m21:26:36.038787 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m21:26:36.041888 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m21:26:36.043618 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics.fact_orders ................... [RUN]
[0m21:26:36.045892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m21:26:36.047436 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m21:26:36.054686 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m21:26:36.068522 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 21:26:36.049110 => 21:26:36.067732
[0m21:26:36.070307 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m21:26:36.079161 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m21:26:36.090982 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:26:36.092644 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m21:26:36.094102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:36.110890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:26:36.112975 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:26:36.114930 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo".analytics_analytics."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    status,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo".analytics_staging."stg_transactions"
WHERE status = 'completed'
GROUP BY user_id, status
  );
  
[0m21:26:41.787608 [debug] [Thread-1 (]: SQL status: SELECT 80000 in 6.0 seconds
[0m21:26:41.794430 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:26:41.796185 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics"."fact_orders" rename to "fact_orders__dbt_backup"
[0m21:26:41.798440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:26:41.805639 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:26:41.807602 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo".analytics_analytics."fact_orders__dbt_tmp" rename to "fact_orders"
[0m21:26:41.809928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:26:41.814821 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m21:26:41.816968 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:26:41.818563 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m21:26:41.824054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:26:41.829759 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics."fact_orders__dbt_backup"
[0m21:26:41.832481 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:26:41.834068 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo".analytics_analytics."fact_orders__dbt_backup" cascade
[0m21:26:41.839463 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:26:41.843116 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 21:26:36.071582 => 21:26:41.842760
[0m21:26:41.844597 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m21:26:41.846838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd727b0f-7295-4e2b-aac8-63c18db1200a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f1307bfd0>]}
[0m21:26:41.848805 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics.fact_orders .............. [[32mSELECT 80000[0m in 5.80s]
[0m21:26:41.850865 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m21:26:41.855035 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:41.856535 [debug] [MainThread]: On master: BEGIN
[0m21:26:41.857872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:41.869679 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:26:41.871801 [debug] [MainThread]: On master: COMMIT
[0m21:26:41.873711 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:41.875428 [debug] [MainThread]: On master: COMMIT
[0m21:26:41.877250 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:26:41.878969 [debug] [MainThread]: On master: Close
[0m21:26:41.881516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:41.883224 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m21:26:41.884917 [info ] [MainThread]: 
[0m21:26:41.886493 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 9.49 seconds (9.49s).
[0m21:26:41.888738 [debug] [MainThread]: Command end result
[0m21:26:41.924441 [info ] [MainThread]: 
[0m21:26:41.927009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:26:41.928948 [info ] [MainThread]: 
[0m21:26:41.930828 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:26:41.933838 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.320038, "process_user_time": 4.860262, "process_kernel_time": 0.200837, "process_mem_max_rss": "109372", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:26:41.936020 [debug] [MainThread]: Command `dbt run` succeeded at 21:26:41.935736 after 10.32 seconds
[0m21:26:41.937809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f18b58590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f15d7d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f18a67550>]}
[0m21:26:41.939642 [debug] [MainThread]: Flushing usage events
[0m21:27:37.990375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a9e51950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a9ff5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a9e51b90>]}


============================== 21:27:37.995785 | 20666370-50fe-440b-a43b-1a5f26d499dc ==============================
[0m21:27:37.995785 [info ] [MainThread]: Running with dbt=1.7.16
[0m21:27:37.997670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:27:38.000460 [info ] [MainThread]: dbt version: 1.7.16
[0m21:27:38.002081 [info ] [MainThread]: python version: 3.11.2
[0m21:27:38.003646 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:27:38.005134 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m21:27:38.148859 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m21:27:38.150891 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m21:27:38.152676 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m21:27:38.154682 [info ] [MainThread]: adapter type: postgres
[0m21:27:38.156441 [info ] [MainThread]: adapter version: 1.7.16
[0m21:27:38.302874 [info ] [MainThread]: Configuration:
[0m21:27:38.304746 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:27:38.306562 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:27:38.308290 [info ] [MainThread]: Required dependencies:
[0m21:27:38.310172 [debug] [MainThread]: Executing "git --help"
[0m21:27:38.314163 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:27:38.315830 [debug] [MainThread]: STDERR: "b''"
[0m21:27:38.317330 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:27:38.318906 [info ] [MainThread]: Connection:
[0m21:27:38.320467 [info ] [MainThread]:   host: postgres
[0m21:27:38.321815 [info ] [MainThread]:   port: 5432
[0m21:27:38.323265 [info ] [MainThread]:   user: demo
[0m21:27:38.324688 [info ] [MainThread]:   database: demo
[0m21:27:38.326180 [info ] [MainThread]:   schema: analytics
[0m21:27:38.327656 [info ] [MainThread]:   connect_timeout: 10
[0m21:27:38.329049 [info ] [MainThread]:   role: None
[0m21:27:38.330497 [info ] [MainThread]:   search_path: None
[0m21:27:38.331867 [info ] [MainThread]:   keepalives_idle: 0
[0m21:27:38.333457 [info ] [MainThread]:   sslmode: None
[0m21:27:38.334922 [info ] [MainThread]:   sslcert: None
[0m21:27:38.336369 [info ] [MainThread]:   sslkey: None
[0m21:27:38.337733 [info ] [MainThread]:   sslrootcert: None
[0m21:27:38.339072 [info ] [MainThread]:   application_name: dbt
[0m21:27:38.340540 [info ] [MainThread]:   retries: 1
[0m21:27:38.342021 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m21:27:38.343819 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:27:38.345128 [debug] [MainThread]: Using postgres connection "debug"
[0m21:27:38.346460 [debug] [MainThread]: On debug: select 1 as id
[0m21:27:38.347731 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:38.361685 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:27:38.365224 [debug] [MainThread]: On debug: Close
[0m21:27:38.367452 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:27:38.369493 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:27:38.371924 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.49855545, "process_user_time": 4.132957, "process_kernel_time": 0.409302, "process_mem_max_rss": "102332", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:27:38.373737 [debug] [MainThread]: Command `dbt debug` succeeded at 21:27:38.373519 after 0.50 seconds
[0m21:27:38.375194 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:27:38.376738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a9e6f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a9e6f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a8703ad0>]}
[0m21:27:38.378277 [debug] [MainThread]: Flushing usage events
[0m21:27:43.095020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8c0e1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8c0e3990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8c0e3ed0>]}


============================== 21:27:43.100300 | b4d6c8d5-6853-4370-9738-919915712212 ==============================
[0m21:27:43.100300 [info ] [MainThread]: Running with dbt=1.7.16
[0m21:27:43.102509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:27:43.605402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4d6c8d5-6853-4370-9738-919915712212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8d208650>]}
[0m21:27:43.726986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4d6c8d5-6853-4370-9738-919915712212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a83ee10>]}
[0m21:27:43.729569 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m21:27:43.754222 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m21:27:44.305463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:27:44.307507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:27:44.326318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4d6c8d5-6853-4370-9738-919915712212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a81e550>]}
[0m21:27:44.382206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4d6c8d5-6853-4370-9738-919915712212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a720950>]}
[0m21:27:44.384481 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:27:44.386611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4d6c8d5-6853-4370-9738-919915712212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a710210>]}
[0m21:27:44.391750 [info ] [MainThread]: 
[0m21:27:44.395424 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:27:44.399580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m21:27:44.424916 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m21:27:44.426675 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m21:27:44.428309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:44.449038 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:27:44.453221 [debug] [ThreadPool]: On list_demo: Close
[0m21:27:44.462717 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m21:27:44.464738 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m21:27:44.466426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:44.481950 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:27:44.485405 [debug] [ThreadPool]: On list_demo: Close
[0m21:27:44.489999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now list_demo_analytics_analytics)
[0m21:27:44.501052 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m21:27:44.502677 [debug] [ThreadPool]: On list_demo_analytics_analytics: BEGIN
[0m21:27:44.504395 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:44.516573 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:27:44.518097 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m21:27:44.519909 [debug] [ThreadPool]: On list_demo_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m21:27:44.526220 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:27:44.529536 [debug] [ThreadPool]: On list_demo_analytics_analytics: ROLLBACK
[0m21:27:44.531373 [debug] [ThreadPool]: On list_demo_analytics_analytics: Close
[0m21:27:44.534250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics, now list_demo_analytics_staging)
[0m21:27:44.540526 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m21:27:44.542177 [debug] [ThreadPool]: On list_demo_analytics_staging: BEGIN
[0m21:27:44.543715 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:44.558163 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:27:44.559933 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m21:27:44.561553 [debug] [ThreadPool]: On list_demo_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:27:44.566907 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:27:44.570116 [debug] [ThreadPool]: On list_demo_analytics_staging: ROLLBACK
[0m21:27:44.571929 [debug] [ThreadPool]: On list_demo_analytics_staging: Close
[0m21:27:44.580929 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:44.582448 [debug] [MainThread]: On master: BEGIN
[0m21:27:44.584246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:44.597699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:27:44.599575 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:44.601313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:27:44.608730 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:27:44.612348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4d6c8d5-6853-4370-9738-919915712212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a874910>]}
[0m21:27:44.614225 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:44.616145 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:44.617723 [debug] [MainThread]: On master: BEGIN
[0m21:27:44.619808 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:27:44.621304 [debug] [MainThread]: On master: COMMIT
[0m21:27:44.622694 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:44.624115 [debug] [MainThread]: On master: COMMIT
[0m21:27:44.625695 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:27:44.627140 [debug] [MainThread]: On master: Close
[0m21:27:44.629753 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:27:44.631487 [info ] [MainThread]: 
[0m21:27:44.635718 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m21:27:44.637361 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_staging.stg_transactions ................ [RUN]
[0m21:27:44.639600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_staging, now model.retail_poc.stg_transactions)
[0m21:27:44.641058 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m21:27:44.656136 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m21:27:44.670647 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 21:27:44.642220 => 21:27:44.669966
[0m21:27:44.672370 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m21:27:44.763080 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m21:27:44.775294 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:27:44.777002 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m21:27:44.778832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:44.793361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:27:44.795512 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:27:44.797574 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo".analytics_staging."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m21:27:53.643000 [debug] [Thread-1 (]: SQL status: SELECT 2500000 in 9.0 seconds
[0m21:27:53.656009 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:27:53.657936 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_staging"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m21:27:53.660332 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:27:53.667871 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:27:53.671433 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo".analytics_staging."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m21:27:53.674451 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:27:53.715576 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m21:27:53.717746 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:27:53.719692 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m21:27:53.724566 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:27:53.743557 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_staging."stg_transactions__dbt_backup"
[0m21:27:53.762753 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:27:53.765148 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo".analytics_staging."stg_transactions__dbt_backup" cascade
[0m21:27:53.803102 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:27:53.807157 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 21:27:44.673664 => 21:27:53.806784
[0m21:27:53.809093 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m21:27:53.811698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4d6c8d5-6853-4370-9738-919915712212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a505990>]}
[0m21:27:53.814073 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_staging.stg_transactions ........... [[32mSELECT 2500000[0m in 9.17s]
[0m21:27:53.816182 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m21:27:53.818834 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m21:27:53.820521 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics.fact_orders ................... [RUN]
[0m21:27:53.822716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m21:27:53.824305 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m21:27:53.831373 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m21:27:53.844940 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 21:27:53.825952 => 21:27:53.844383
[0m21:27:53.846928 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m21:27:53.856866 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m21:27:53.874376 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:27:53.876151 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m21:27:53.877797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:53.891719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:27:53.894285 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:27:53.896463 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo".analytics_analytics."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    status,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo".analytics_staging."stg_transactions"
WHERE status = 'completed'
GROUP BY user_id, status
  );
  
[0m21:28:01.870788 [debug] [Thread-1 (]: SQL status: SELECT 80000 in 8.0 seconds
[0m21:28:01.877429 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:28:01.879112 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics"."fact_orders" rename to "fact_orders__dbt_backup"
[0m21:28:01.881141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:28:01.887448 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:28:01.889062 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo".analytics_analytics."fact_orders__dbt_tmp" rename to "fact_orders"
[0m21:28:01.891247 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:28:01.896597 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m21:28:01.898306 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:28:01.899796 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m21:28:01.931131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:28:01.937007 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics."fact_orders__dbt_backup"
[0m21:28:01.939618 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:28:01.941458 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo".analytics_analytics."fact_orders__dbt_backup" cascade
[0m21:28:01.959899 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:28:01.963931 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 21:27:53.848826 => 21:28:01.963556
[0m21:28:01.965953 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m21:28:01.968697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4d6c8d5-6853-4370-9738-919915712212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a4edfd0>]}
[0m21:28:01.971116 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics.fact_orders .............. [[32mSELECT 80000[0m in 8.15s]
[0m21:28:01.973573 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m21:28:01.977886 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:01.979458 [debug] [MainThread]: On master: BEGIN
[0m21:28:01.980972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:28:01.993796 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:28:01.996077 [debug] [MainThread]: On master: COMMIT
[0m21:28:01.997639 [debug] [MainThread]: Using postgres connection "master"
[0m21:28:01.999508 [debug] [MainThread]: On master: COMMIT
[0m21:28:02.001170 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:28:02.002882 [debug] [MainThread]: On master: Close
[0m21:28:02.005176 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:28:02.006910 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m21:28:02.008809 [info ] [MainThread]: 
[0m21:28:02.010409 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 17.61 seconds (17.61s).
[0m21:28:02.012905 [debug] [MainThread]: Command end result
[0m21:28:02.044136 [info ] [MainThread]: 
[0m21:28:02.046053 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:28:02.047843 [info ] [MainThread]: 
[0m21:28:02.050179 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:28:02.053659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 19.054245, "process_user_time": 4.841007, "process_kernel_time": 0.253052, "process_mem_max_rss": "109384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:28:02.055958 [debug] [MainThread]: Command `dbt run` succeeded at 21:28:02.055681 after 19.06 seconds
[0m21:28:02.057839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8a8a2f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8c11bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e8c116c90>]}
[0m21:28:02.059650 [debug] [MainThread]: Flushing usage events
[0m21:30:08.594040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03293ab3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03292020d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03291d1890>]}


============================== 21:30:08.604425 | 53da4d7c-db82-4379-baf0-6c3d84d9d6a0 ==============================
[0m21:30:08.604425 [info ] [MainThread]: Running with dbt=1.7.16
[0m21:30:08.606423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'send_anonymous_usage_stats': 'True'}
[0m21:30:08.609603 [info ] [MainThread]: dbt version: 1.7.16
[0m21:30:08.611232 [info ] [MainThread]: python version: 3.11.2
[0m21:30:08.612776 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:30:08.614423 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m21:30:08.781712 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m21:30:08.819944 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m21:30:08.826455 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m21:30:08.829332 [info ] [MainThread]: adapter type: postgres
[0m21:30:08.831467 [info ] [MainThread]: adapter version: 1.7.16
[0m21:30:09.024841 [info ] [MainThread]: Configuration:
[0m21:30:09.027110 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:30:09.028993 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:30:09.030846 [info ] [MainThread]: Required dependencies:
[0m21:30:09.032570 [debug] [MainThread]: Executing "git --help"
[0m21:30:09.036341 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:30:09.038032 [debug] [MainThread]: STDERR: "b''"
[0m21:30:09.039479 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:30:09.040942 [info ] [MainThread]: Connection:
[0m21:30:09.042403 [info ] [MainThread]:   host: postgres
[0m21:30:09.043756 [info ] [MainThread]:   port: 5432
[0m21:30:09.045116 [info ] [MainThread]:   user: demo
[0m21:30:09.046533 [info ] [MainThread]:   database: demo
[0m21:30:09.048009 [info ] [MainThread]:   schema: analytics
[0m21:30:09.049440 [info ] [MainThread]:   connect_timeout: 10
[0m21:30:09.050836 [info ] [MainThread]:   role: None
[0m21:30:09.052212 [info ] [MainThread]:   search_path: None
[0m21:30:09.053676 [info ] [MainThread]:   keepalives_idle: 0
[0m21:30:09.055207 [info ] [MainThread]:   sslmode: None
[0m21:30:09.056663 [info ] [MainThread]:   sslcert: None
[0m21:30:09.058081 [info ] [MainThread]:   sslkey: None
[0m21:30:09.059510 [info ] [MainThread]:   sslrootcert: None
[0m21:30:09.060914 [info ] [MainThread]:   application_name: dbt
[0m21:30:09.062263 [info ] [MainThread]:   retries: 1
[0m21:30:09.063682 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m21:30:09.065363 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:30:09.066612 [debug] [MainThread]: Using postgres connection "debug"
[0m21:30:09.067973 [debug] [MainThread]: On debug: select 1 as id
[0m21:30:09.069334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:09.085765 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:30:09.088934 [debug] [MainThread]: On debug: Close
[0m21:30:09.090838 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:30:09.092667 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:30:09.094986 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6011484, "process_user_time": 4.5214, "process_kernel_time": 0.411036, "process_mem_max_rss": "102512", "process_out_blocks": "1216", "process_in_blocks": "0"}
[0m21:30:09.097103 [debug] [MainThread]: Command `dbt debug` succeeded at 21:30:09.096845 after 0.60 seconds
[0m21:30:09.098718 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:30:09.100358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0329a34150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f032a8535d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0327b06750>]}
[0m21:30:09.102114 [debug] [MainThread]: Flushing usage events
[0m21:30:14.250152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff498f0d950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff498f0df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff498f0f890>]}


============================== 21:30:14.255208 | 2172220d-d5b1-4118-8288-613e0f509d60 ==============================
[0m21:30:14.255208 [info ] [MainThread]: Running with dbt=1.7.16
[0m21:30:14.257440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:30:14.603679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2172220d-d5b1-4118-8288-613e0f509d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4977c87d0>]}
[0m21:30:14.745856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2172220d-d5b1-4118-8288-613e0f509d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4990d2150>]}
[0m21:30:14.749399 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m21:30:14.780158 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m21:30:14.955540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:30:14.957685 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:30:14.968473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2172220d-d5b1-4118-8288-613e0f509d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff498f25490>]}
[0m21:30:15.004763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2172220d-d5b1-4118-8288-613e0f509d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4977308d0>]}
[0m21:30:15.006558 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:30:15.008250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2172220d-d5b1-4118-8288-613e0f509d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49771c150>]}
[0m21:30:15.012690 [info ] [MainThread]: 
[0m21:30:15.015450 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:30:15.018370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m21:30:15.038232 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m21:30:15.040081 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m21:30:15.041893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:30:15.057711 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:30:15.062242 [debug] [ThreadPool]: On list_demo: Close
[0m21:30:15.069711 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m21:30:15.071633 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m21:30:15.073363 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:15.086009 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m21:30:15.089896 [debug] [ThreadPool]: On list_demo: Close
[0m21:30:15.093651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now create_demo_analytics_staging)
[0m21:30:15.096390 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_staging"
"
[0m21:30:15.108221 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_staging"
[0m21:30:15.110485 [debug] [ThreadPool]: On create_demo_analytics_staging: BEGIN
[0m21:30:15.112383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:15.126540 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:30:15.129207 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_staging"
[0m21:30:15.131079 [debug] [ThreadPool]: On create_demo_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_staging"} */
create schema if not exists analytics_staging
[0m21:30:15.134725 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m21:30:15.137657 [debug] [ThreadPool]: On create_demo_analytics_staging: COMMIT
[0m21:30:15.139987 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_staging"
[0m21:30:15.142453 [debug] [ThreadPool]: On create_demo_analytics_staging: COMMIT
[0m21:30:15.149131 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m21:30:15.151747 [debug] [ThreadPool]: On create_demo_analytics_staging: Close
[0m21:30:15.156791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_staging, now create_demo_analytics_analytics)
[0m21:30:15.159848 [debug] [ThreadPool]: Creating schema "database: "demo"
schema: "analytics_analytics"
"
[0m21:30:15.167271 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics"
[0m21:30:15.169486 [debug] [ThreadPool]: On create_demo_analytics_analytics: BEGIN
[0m21:30:15.171724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:15.188820 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:30:15.192267 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics"
[0m21:30:15.194721 [debug] [ThreadPool]: On create_demo_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "create_demo_analytics_analytics"} */
create schema if not exists analytics_analytics
[0m21:30:15.197871 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m21:30:15.200990 [debug] [ThreadPool]: On create_demo_analytics_analytics: COMMIT
[0m21:30:15.202638 [debug] [ThreadPool]: Using postgres connection "create_demo_analytics_analytics"
[0m21:30:15.204090 [debug] [ThreadPool]: On create_demo_analytics_analytics: COMMIT
[0m21:30:15.207520 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m21:30:15.208954 [debug] [ThreadPool]: On create_demo_analytics_analytics: Close
[0m21:30:15.213374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_demo_analytics_analytics, now list_demo_analytics_staging)
[0m21:30:15.224705 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m21:30:15.226313 [debug] [ThreadPool]: On list_demo_analytics_staging: BEGIN
[0m21:30:15.227693 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:15.245006 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:30:15.249007 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m21:30:15.250814 [debug] [ThreadPool]: On list_demo_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:30:15.257330 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:30:15.262222 [debug] [ThreadPool]: On list_demo_analytics_staging: ROLLBACK
[0m21:30:15.264176 [debug] [ThreadPool]: On list_demo_analytics_staging: Close
[0m21:30:15.267110 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_staging, now list_demo_analytics_analytics)
[0m21:30:15.272523 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m21:30:15.274352 [debug] [ThreadPool]: On list_demo_analytics_analytics: BEGIN
[0m21:30:15.276071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:30:15.290407 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:30:15.292110 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m21:30:15.293679 [debug] [ThreadPool]: On list_demo_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m21:30:15.298919 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m21:30:15.302253 [debug] [ThreadPool]: On list_demo_analytics_analytics: ROLLBACK
[0m21:30:15.304316 [debug] [ThreadPool]: On list_demo_analytics_analytics: Close
[0m21:30:15.313372 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:15.316530 [debug] [MainThread]: On master: BEGIN
[0m21:30:15.318047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:30:15.330746 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:15.332593 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:15.334527 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:30:15.345362 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:30:15.350189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2172220d-d5b1-4118-8288-613e0f509d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4976da790>]}
[0m21:30:15.353049 [debug] [MainThread]: On master: ROLLBACK
[0m21:30:15.355771 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:15.358299 [debug] [MainThread]: On master: BEGIN
[0m21:30:15.361407 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:15.363880 [debug] [MainThread]: On master: COMMIT
[0m21:30:15.366496 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:15.368697 [debug] [MainThread]: On master: COMMIT
[0m21:30:15.372394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:30:15.375402 [debug] [MainThread]: On master: Close
[0m21:30:15.381003 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:30:15.383770 [info ] [MainThread]: 
[0m21:30:15.406526 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m21:30:15.409804 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_staging.stg_transactions ................ [RUN]
[0m21:30:15.413212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics, now model.retail_poc.stg_transactions)
[0m21:30:15.415465 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m21:30:15.438628 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m21:30:15.456173 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 21:30:15.417087 => 21:30:15.454953
[0m21:30:15.458778 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m21:30:15.577224 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m21:30:15.615965 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:30:15.620377 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m21:30:15.625761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:15.648965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:15.653695 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:30:15.657594 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo".analytics_staging."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m21:30:15.677173 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m21:30:15.710357 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:30:15.712864 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo".analytics_staging."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m21:30:15.717763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:15.774706 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m21:30:15.778206 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:30:15.780747 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m21:30:15.787872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:15.814676 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_staging."stg_transactions__dbt_backup"
[0m21:30:15.834763 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:30:15.837476 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo".analytics_staging."stg_transactions__dbt_backup" cascade
[0m21:30:15.841747 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:30:15.851238 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 21:30:15.460427 => 21:30:15.850321
[0m21:30:15.855385 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m21:30:15.863748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2172220d-d5b1-4118-8288-613e0f509d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49782c850>]}
[0m21:30:15.869215 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_staging.stg_transactions ........... [[32mSELECT 0[0m in 0.45s]
[0m21:30:15.873360 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m21:30:15.880616 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m21:30:15.886381 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics.fact_orders ................... [RUN]
[0m21:30:15.892182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m21:30:15.895960 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m21:30:15.909539 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m21:30:15.933734 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 21:30:15.898559 => 21:30:15.932616
[0m21:30:15.939296 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m21:30:15.965758 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m21:30:15.983653 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:30:15.986439 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m21:30:15.989124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:30:16.007727 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:30:16.010125 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:30:16.012381 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo".analytics_analytics."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    status,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo".analytics_staging."stg_transactions"
WHERE status = 'completed'
GROUP BY user_id, status
  );
  
[0m21:30:16.024073 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m21:30:16.032841 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:30:16.035201 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo".analytics_analytics."fact_orders__dbt_tmp" rename to "fact_orders"
[0m21:30:16.037615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:30:16.044443 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m21:30:16.046747 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:30:16.048754 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m21:30:16.053725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:30:16.061577 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics."fact_orders__dbt_backup"
[0m21:30:16.064578 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:30:16.066987 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo".analytics_analytics."fact_orders__dbt_backup" cascade
[0m21:30:16.070068 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:30:16.075178 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 21:30:15.942044 => 21:30:16.074368
[0m21:30:16.077502 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m21:30:16.080696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2172220d-d5b1-4118-8288-613e0f509d60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff498f26290>]}
[0m21:30:16.083164 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics.fact_orders .............. [[32mSELECT 0[0m in 0.19s]
[0m21:30:16.085420 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m21:30:16.089916 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:16.092464 [debug] [MainThread]: On master: BEGIN
[0m21:30:16.094738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:30:16.110157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:30:16.112186 [debug] [MainThread]: On master: COMMIT
[0m21:30:16.113754 [debug] [MainThread]: Using postgres connection "master"
[0m21:30:16.115850 [debug] [MainThread]: On master: COMMIT
[0m21:30:16.118561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:30:16.120774 [debug] [MainThread]: On master: Close
[0m21:30:16.124937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:30:16.127251 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m21:30:16.129376 [info ] [MainThread]: 
[0m21:30:16.132954 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m21:30:16.135664 [debug] [MainThread]: Command end result
[0m21:30:16.179925 [info ] [MainThread]: 
[0m21:30:16.182472 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:30:16.184237 [info ] [MainThread]: 
[0m21:30:16.188610 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:30:16.191537 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0378308, "process_user_time": 5.010837, "process_kernel_time": 0.245629, "process_mem_max_rss": "110348", "process_out_blocks": "96", "process_in_blocks": "0"}
[0m21:30:16.193454 [debug] [MainThread]: Command `dbt run` succeeded at 21:30:16.193175 after 2.04 seconds
[0m21:30:16.195067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff498ef9950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49a2c30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff49cfc8610>]}
[0m21:30:16.196655 [debug] [MainThread]: Flushing usage events
[0m21:31:57.075181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71444497d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7144a42b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7144482050>]}


============================== 21:31:57.080350 | 0690ccda-c916-4d3e-90f8-ee9cf5c92c13 ==============================
[0m21:31:57.080350 [info ] [MainThread]: Running with dbt=1.7.16
[0m21:31:57.082305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug --profiles-dir /usr/app/dbt', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:57.085087 [info ] [MainThread]: dbt version: 1.7.16
[0m21:31:57.086636 [info ] [MainThread]: python version: 3.11.2
[0m21:31:57.088725 [info ] [MainThread]: python path: /usr/local/bin/python
[0m21:31:57.090144 [info ] [MainThread]: os info: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m21:31:57.234081 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m21:31:57.236029 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m21:31:57.237937 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m21:31:57.240007 [info ] [MainThread]: adapter type: postgres
[0m21:31:57.242123 [info ] [MainThread]: adapter version: 1.7.16
[0m21:31:57.408792 [info ] [MainThread]: Configuration:
[0m21:31:57.410849 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:31:57.412733 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:31:57.414512 [info ] [MainThread]: Required dependencies:
[0m21:31:57.416454 [debug] [MainThread]: Executing "git --help"
[0m21:31:57.420174 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:31:57.421947 [debug] [MainThread]: STDERR: "b''"
[0m21:31:57.423600 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:31:57.425213 [info ] [MainThread]: Connection:
[0m21:31:57.426700 [info ] [MainThread]:   host: postgres
[0m21:31:57.428323 [info ] [MainThread]:   port: 5432
[0m21:31:57.429904 [info ] [MainThread]:   user: demo
[0m21:31:57.431767 [info ] [MainThread]:   database: demo
[0m21:31:57.433650 [info ] [MainThread]:   schema: analytics
[0m21:31:57.435361 [info ] [MainThread]:   connect_timeout: 10
[0m21:31:57.436878 [info ] [MainThread]:   role: None
[0m21:31:57.438334 [info ] [MainThread]:   search_path: None
[0m21:31:57.439732 [info ] [MainThread]:   keepalives_idle: 0
[0m21:31:57.441128 [info ] [MainThread]:   sslmode: None
[0m21:31:57.442459 [info ] [MainThread]:   sslcert: None
[0m21:31:57.443799 [info ] [MainThread]:   sslkey: None
[0m21:31:57.445267 [info ] [MainThread]:   sslrootcert: None
[0m21:31:57.446724 [info ] [MainThread]:   application_name: dbt
[0m21:31:57.448513 [info ] [MainThread]:   retries: 1
[0m21:31:57.450368 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m21:31:57.452398 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:31:57.453961 [debug] [MainThread]: Using postgres connection "debug"
[0m21:31:57.455481 [debug] [MainThread]: On debug: select 1 as id
[0m21:31:57.456988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:31:57.471135 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m21:31:57.474051 [debug] [MainThread]: On debug: Close
[0m21:31:57.476025 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:31:57.477973 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:31:57.480209 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.5022057, "process_user_time": 4.184801, "process_kernel_time": 0.110126, "process_mem_max_rss": "102416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:31:57.482036 [debug] [MainThread]: Command `dbt debug` succeeded at 21:31:57.481813 after 0.50 seconds
[0m21:31:57.483431 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:31:57.485123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7142dbf690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7142d226d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7148426950>]}
[0m21:31:57.486945 [debug] [MainThread]: Flushing usage events
[0m21:32:02.159370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab217ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab2fbc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab217a210>]}


============================== 21:32:02.164488 | 18eac807-1bcd-4937-ac9d-c4b46f5df616 ==============================
[0m21:32:02.164488 [info ] [MainThread]: Running with dbt=1.7.16
[0m21:32:02.166541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir /usr/app/dbt --project-dir /usr/app/dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:32:02.433939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18eac807-1bcd-4937-ac9d-c4b46f5df616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab2fbcd10>]}
[0m21:32:02.540313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18eac807-1bcd-4937-ac9d-c4b46f5df616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab27d5b50>]}
[0m21:32:02.543066 [info ] [MainThread]: Registered adapter: postgres=1.7.16
[0m21:32:02.573860 [debug] [MainThread]: checksum: b42e23759fbef548c33c6e49ebf263a93f046443b71b5f37fe49de1c6429a7cf, vars: {}, profile: , target: , version: 1.7.16
[0m21:32:02.729772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:32:02.733171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:32:02.745492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18eac807-1bcd-4937-ac9d-c4b46f5df616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab0846990>]}
[0m21:32:02.790427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18eac807-1bcd-4937-ac9d-c4b46f5df616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab098cad0>]}
[0m21:32:02.792763 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m21:32:02.794706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18eac807-1bcd-4937-ac9d-c4b46f5df616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab0978d10>]}
[0m21:32:02.798897 [info ] [MainThread]: 
[0m21:32:02.802147 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:32:02.809237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_demo'
[0m21:32:02.841860 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m21:32:02.843826 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m21:32:02.845738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:02.860139 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:32:02.863524 [debug] [ThreadPool]: On list_demo: Close
[0m21:32:02.870372 [debug] [ThreadPool]: Using postgres connection "list_demo"
[0m21:32:02.872677 [debug] [ThreadPool]: On list_demo: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo"} */

    select distinct nspname from pg_namespace
  
[0m21:32:02.874564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:02.888711 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m21:32:02.894303 [debug] [ThreadPool]: On list_demo: Close
[0m21:32:02.900065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo, now list_demo_analytics_analytics)
[0m21:32:02.911762 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m21:32:02.913698 [debug] [ThreadPool]: On list_demo_analytics_analytics: BEGIN
[0m21:32:02.915411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:02.931270 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:32:02.932959 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_analytics"
[0m21:32:02.934309 [debug] [ThreadPool]: On list_demo_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_analytics"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m21:32:02.939763 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:32:02.943013 [debug] [ThreadPool]: On list_demo_analytics_analytics: ROLLBACK
[0m21:32:02.944761 [debug] [ThreadPool]: On list_demo_analytics_analytics: Close
[0m21:32:02.948843 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_demo_analytics_analytics, now list_demo_analytics_staging)
[0m21:32:02.953832 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m21:32:02.955316 [debug] [ThreadPool]: On list_demo_analytics_staging: BEGIN
[0m21:32:02.956562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:02.968761 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m21:32:02.970564 [debug] [ThreadPool]: Using postgres connection "list_demo_analytics_staging"
[0m21:32:02.972148 [debug] [ThreadPool]: On list_demo_analytics_staging: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "list_demo_analytics_staging"} */
select
      'demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_staging'
    union all
    select
      'demo' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_staging'
  
[0m21:32:02.979577 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m21:32:02.984740 [debug] [ThreadPool]: On list_demo_analytics_staging: ROLLBACK
[0m21:32:02.986725 [debug] [ThreadPool]: On list_demo_analytics_staging: Close
[0m21:32:02.996047 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:02.997662 [debug] [MainThread]: On master: BEGIN
[0m21:32:02.999416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:03.013586 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:32:03.015615 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:03.017196 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:32:03.023641 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m21:32:03.027094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18eac807-1bcd-4937-ac9d-c4b46f5df616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab0814410>]}
[0m21:32:03.028864 [debug] [MainThread]: On master: ROLLBACK
[0m21:32:03.030502 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:03.031874 [debug] [MainThread]: On master: BEGIN
[0m21:32:03.033860 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:32:03.035236 [debug] [MainThread]: On master: COMMIT
[0m21:32:03.036705 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:03.038107 [debug] [MainThread]: On master: COMMIT
[0m21:32:03.039707 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:32:03.041048 [debug] [MainThread]: On master: Close
[0m21:32:03.043187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:32:03.044814 [info ] [MainThread]: 
[0m21:32:03.049807 [debug] [Thread-1 (]: Began running node model.retail_poc.stg_transactions
[0m21:32:03.052130 [info ] [Thread-1 (]: 1 of 2 START sql table model analytics_staging.stg_transactions ................ [RUN]
[0m21:32:03.054305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_demo_analytics_staging, now model.retail_poc.stg_transactions)
[0m21:32:03.055930 [debug] [Thread-1 (]: Began compiling node model.retail_poc.stg_transactions
[0m21:32:03.069930 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.stg_transactions"
[0m21:32:03.082889 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (compile): 21:32:03.057265 => 21:32:03.082308
[0m21:32:03.084511 [debug] [Thread-1 (]: Began executing node model.retail_poc.stg_transactions
[0m21:32:03.166243 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.stg_transactions"
[0m21:32:03.179401 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:32:03.181046 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: BEGIN
[0m21:32:03.182692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:03.197868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:03.200010 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:32:03.201710 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */

  
    

  create  table "demo".analytics_staging."stg_transactions__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    transaction_id AS order_id,
    user_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    currency,
    status,
    created_at AS order_date
FROM public.transactions
  );
  
[0m21:32:03.937980 [debug] [Thread-1 (]: SQL status: SELECT 500000 in 1.0 seconds
[0m21:32:03.950283 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:32:03.952315 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo"."analytics_staging"."stg_transactions" rename to "stg_transactions__dbt_backup"
[0m21:32:03.954783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:03.961361 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:32:03.963425 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
alter table "demo".analytics_staging."stg_transactions__dbt_tmp" rename to "stg_transactions"
[0m21:32:03.965742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:04.000945 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m21:32:04.003046 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:32:04.005003 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: COMMIT
[0m21:32:04.018395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:32:04.036881 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_staging."stg_transactions__dbt_backup"
[0m21:32:04.049856 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.stg_transactions"
[0m21:32:04.052057 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.stg_transactions"} */
drop table if exists "demo".analytics_staging."stg_transactions__dbt_backup" cascade
[0m21:32:04.057545 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:32:04.063635 [debug] [Thread-1 (]: Timing info for model.retail_poc.stg_transactions (execute): 21:32:03.085776 => 21:32:04.062992
[0m21:32:04.065759 [debug] [Thread-1 (]: On model.retail_poc.stg_transactions: Close
[0m21:32:04.068855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eac807-1bcd-4937-ac9d-c4b46f5df616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab076ff90>]}
[0m21:32:04.071896 [info ] [Thread-1 (]: 1 of 2 OK created sql table model analytics_staging.stg_transactions ........... [[32mSELECT 500000[0m in 1.01s]
[0m21:32:04.075067 [debug] [Thread-1 (]: Finished running node model.retail_poc.stg_transactions
[0m21:32:04.078456 [debug] [Thread-1 (]: Began running node model.retail_poc.fact_orders
[0m21:32:04.080470 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics_analytics.fact_orders ................... [RUN]
[0m21:32:04.082911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.retail_poc.stg_transactions, now model.retail_poc.fact_orders)
[0m21:32:04.084750 [debug] [Thread-1 (]: Began compiling node model.retail_poc.fact_orders
[0m21:32:04.091299 [debug] [Thread-1 (]: Writing injected SQL for node "model.retail_poc.fact_orders"
[0m21:32:04.103530 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (compile): 21:32:04.086147 => 21:32:04.103008
[0m21:32:04.105035 [debug] [Thread-1 (]: Began executing node model.retail_poc.fact_orders
[0m21:32:04.113706 [debug] [Thread-1 (]: Writing runtime sql for node "model.retail_poc.fact_orders"
[0m21:32:04.126813 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:32:04.128526 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: BEGIN
[0m21:32:04.130257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:04.142855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m21:32:04.144977 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:32:04.147038 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */

  
    

  create  table "demo".analytics_analytics."fact_orders__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    user_id,
    status,
    COUNT(order_id) AS total_orders,
    SUM(total_amount) AS total_spent,
    MIN(order_date) AS first_order_date,
    MAX(order_date) AS last_order_date
FROM "demo".analytics_staging."stg_transactions"
WHERE status = 'completed'
GROUP BY user_id, status
  );
  
[0m21:32:06.128414 [debug] [Thread-1 (]: SQL status: SELECT 79753 in 2.0 seconds
[0m21:32:06.136240 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:32:06.138194 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo"."analytics_analytics"."fact_orders" rename to "fact_orders__dbt_backup"
[0m21:32:06.142144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:06.150787 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:32:06.153142 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
alter table "demo".analytics_analytics."fact_orders__dbt_tmp" rename to "fact_orders"
[0m21:32:06.157101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m21:32:06.163572 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m21:32:06.165994 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:32:06.167743 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: COMMIT
[0m21:32:06.176965 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m21:32:06.184015 [debug] [Thread-1 (]: Applying DROP to: "demo".analytics_analytics."fact_orders__dbt_backup"
[0m21:32:06.187314 [debug] [Thread-1 (]: Using postgres connection "model.retail_poc.fact_orders"
[0m21:32:06.190097 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: /* {"app": "dbt", "dbt_version": "1.7.16", "profile_name": "retail_poc", "target_name": "dev", "node_id": "model.retail_poc.fact_orders"} */
drop table if exists "demo".analytics_analytics."fact_orders__dbt_backup" cascade
[0m21:32:06.195342 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m21:32:06.200475 [debug] [Thread-1 (]: Timing info for model.retail_poc.fact_orders (execute): 21:32:04.106370 => 21:32:06.200062
[0m21:32:06.202841 [debug] [Thread-1 (]: On model.retail_poc.fact_orders: Close
[0m21:32:06.207183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eac807-1bcd-4937-ac9d-c4b46f5df616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab0ada310>]}
[0m21:32:06.210737 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics_analytics.fact_orders .............. [[32mSELECT 79753[0m in 2.12s]
[0m21:32:06.213840 [debug] [Thread-1 (]: Finished running node model.retail_poc.fact_orders
[0m21:32:06.220619 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:06.223261 [debug] [MainThread]: On master: BEGIN
[0m21:32:06.226257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:32:06.241189 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m21:32:06.243531 [debug] [MainThread]: On master: COMMIT
[0m21:32:06.247096 [debug] [MainThread]: Using postgres connection "master"
[0m21:32:06.249407 [debug] [MainThread]: On master: COMMIT
[0m21:32:06.253223 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m21:32:06.255797 [debug] [MainThread]: On master: Close
[0m21:32:06.260121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:06.262562 [debug] [MainThread]: Connection 'model.retail_poc.fact_orders' was properly closed.
[0m21:32:06.265235 [info ] [MainThread]: 
[0m21:32:06.268650 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m21:32:06.271753 [debug] [MainThread]: Command end result
[0m21:32:06.316746 [info ] [MainThread]: 
[0m21:32:06.319093 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:32:06.321443 [info ] [MainThread]: 
[0m21:32:06.325109 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:32:06.332438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.285182, "process_user_time": 4.304285, "process_kernel_time": 0.193336, "process_mem_max_rss": "108920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:32:06.336891 [debug] [MainThread]: Command `dbt run` succeeded at 21:32:06.335584 after 4.29 seconds
[0m21:32:06.339261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab273abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab0936fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcab611c650>]}
[0m21:32:06.342287 [debug] [MainThread]: Flushing usage events
